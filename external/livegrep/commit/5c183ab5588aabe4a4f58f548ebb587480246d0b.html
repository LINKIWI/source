<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Update to upstream re2. - livegrep - Fast, regular expression code search service</title>
<meta name="description" content="Fast, regular expression code search service" />
<meta name="author" content="Kevin Lin" />
<link rel="icon" type="image/png" href="https://static.kevinlin.info/favicon.png" />
<link rel="alternate" type="application/atom+xml" title="livegrep Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="livegrep Atom Feed (tags)" href="../tags.xml" />
<style type="text/css">
body{color:#000;background-color:#fff;font-family:monospace}h1,h2,h3,h4,h5,h6{font-size:1em;margin:0}img,h1,h2{vertical-align:middle}img{border:0}a:target{background-color:#ccc}a.d,a.h,a.i{text-decoration:none}a.line{text-decoration:none;user-select:none}#blob a{color:#555}#blob a:hover{color:blue;text-decoration:none}table thead td{font-weight:bold}table td{padding:0 .4em}table td pre{margin:0}#content table td{vertical-align:top;white-space:nowrap}#branches tr:hover td,#tags tr:hover td,#index tr:hover td,#log tr:hover td,#files tr:hover td{background-color:#eee}#index tr td:nth-child(2),#tags tr td:nth-child(3),#branches tr td:nth-child(3),#log tr td:nth-child(2){white-space:normal}td.num{text-align:right}.desc{color:#555}hr{border:0;border-top:1px solid #555;height:1px}pre{font-family:monospace}pre a.h{color:#00a}.A,span.i,pre a.i{color:#070}.D,span.d,pre a.d{color:#e00}pre a.h:hover,pre a.i:hover,pre a.d:hover{text-decoration:none}
</style>
</head>
<body>
<table><tr><td><a href="/"><img src="https://static.kevinlin.info/favicon.png" alt="" width="32" height="32" /></a></td><td><h1>livegrep</h1><span class="desc">Fast, regular expression code search service</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://source.static.kevinlin.info/external/livegrep.git">https://source.static.kevinlin.info/external/livegrep.git</a></td></tr><tr><td></td><td>
<a href="../log">Log</a> | <a href="../files">Files</a> | <a href="../refs">Refs</a> | <a href="../file/README.md">README</a> | <a href="../file/COPYING">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/5c183ab5588aabe4a4f58f548ebb587480246d0b">5c183ab5588aabe4a4f58f548ebb587480246d0b</a>
<b>parent</b> <a href="../commit/23cd22f625a387809657da277a5df14ed4a3d70c">23cd22f625a387809657da277a5df14ed4a3d70c</a>
<b>Author:</b> Nelson Elhage &lt;<a href="mailto:nelhage@nelhage.com">nelhage@nelhage.com</a>&gt;
<b>Date:</b>   Sat 28 Mar 2015 15:59:01 +0000

Update to upstream re2.

Update update.sh for new Github hosting.

<b>Diffstat:</b>
<table><tr><td class="A">A</td><td><a href="#h0">src/vendor/re2/.gitignore</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h1">src/vendor/re2/.hg_archival.txt</a></td><td> | </td><td class="num">5</td><td><span class="i"></span><span class="d">-----</span></td></tr>
<tr><td class="D">D</td><td><a href="#h2">src/vendor/re2/.hgignore</a></td><td> | </td><td class="num">7</td><td><span class="i"></span><span class="d">-------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h3">src/vendor/re2/CONTRIBUTING.md</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/vendor/re2/Makefile</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="A">A</td><td><a href="#h5">src/vendor/re2/lib/git/commit-msg.hook</a></td><td> | </td><td class="num">104</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/vendor/re2/re2/bitstate.cc</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/vendor/re2/re2/compile.cc</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/vendor/re2/re2/dfa.cc</a></td><td> | </td><td class="num">21</td><td><span class="i">+++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/vendor/re2/re2/filtered_re2.cc</a></td><td> | </td><td class="num">17</td><td><span class="i">+++++++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/vendor/re2/re2/filtered_re2.h</a></td><td> | </td><td class="num">10</td><td><span class="i">+++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">src/vendor/re2/re2/mimics_pcre.cc</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">src/vendor/re2/re2/nfa.cc</a></td><td> | </td><td class="num">5</td><td><span class="i">+++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">src/vendor/re2/re2/parse.cc</a></td><td> | </td><td class="num">14</td><td><span class="i">+++++++++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">src/vendor/re2/re2/prefilter.cc</a></td><td> | </td><td class="num">10</td><td><span class="i">+++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">src/vendor/re2/re2/prefilter.h</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">src/vendor/re2/re2/prefilter_tree.cc</a></td><td> | </td><td class="num">46</td><td><span class="i">+++++++++++++++++++++++++</span><span class="d">---------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">src/vendor/re2/re2/prefilter_tree.h</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">src/vendor/re2/re2/prog.h</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">src/vendor/re2/re2/re2.cc</a></td><td> | </td><td class="num">39</td><td><span class="i">++++++++++++++++++++++</span><span class="d">-----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">src/vendor/re2/re2/re2.h</a></td><td> | </td><td class="num">6</td><td><span class="i">++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">src/vendor/re2/re2/regexp.cc</a></td><td> | </td><td class="num">22</td><td><span class="i">+++++++++++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">src/vendor/re2/re2/regexp.h</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">src/vendor/re2/re2/set.cc</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">src/vendor/re2/re2/set.h</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">src/vendor/re2/re2/simplify.cc</a></td><td> | </td><td class="num">3</td><td><span class="i">+</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">src/vendor/re2/re2/stringpiece.h</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h27">src/vendor/re2/re2/testing/dfa_test.cc</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h28">src/vendor/re2/re2/testing/exhaustive_tester.cc</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h29">src/vendor/re2/re2/testing/exhaustive_tester.h</a></td><td> | </td><td class="num">12</td><td><span class="i">+++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h30">src/vendor/re2/re2/testing/filtered_re2_test.cc</a></td><td> | </td><td class="num">10</td><td><span class="i">+++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h31">src/vendor/re2/re2/testing/null_walker.cc</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h32">src/vendor/re2/re2/testing/possible_match_test.cc</a></td><td> | </td><td class="num">19</td><td><span class="i">++++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h33">src/vendor/re2/re2/testing/random_test.cc</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h34">src/vendor/re2/re2/testing/re2_arg_test.cc</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h35">src/vendor/re2/re2/testing/re2_test.cc</a></td><td> | </td><td class="num">78</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h36">src/vendor/re2/re2/testing/regexp_generator.cc</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h37">src/vendor/re2/re2/testing/regexp_generator.h</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h38">src/vendor/re2/re2/testing/regexp_test.cc</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h39">src/vendor/re2/re2/testing/required_prefix_test.cc</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h40">src/vendor/re2/re2/testing/string_generator.cc</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h41">src/vendor/re2/re2/testing/string_generator.h</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h42">src/vendor/re2/re2/testing/tester.cc</a></td><td> | </td><td class="num">16</td><td><span class="i">+++++++++++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h43">src/vendor/re2/re2/testing/tester.h</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h44">src/vendor/re2/re2/tostring.cc</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h45">src/vendor/re2/re2/unicode_casefold.h</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h46">src/vendor/re2/re2/unicode_groups.h</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h47">src/vendor/re2/re2/walker-inl.h</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h48">src/vendor/re2/util/arena.cc</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h49">src/vendor/re2/util/arena.h</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h50">src/vendor/re2/util/atomicops.h</a></td><td> | </td><td class="num">43</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h51">src/vendor/re2/util/logging.h</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h52">src/vendor/re2/util/pcre.cc</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h53">src/vendor/re2/util/pcre.h</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h54">src/vendor/re2/util/sparse_array.h</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h55">src/vendor/re2/util/sparse_set.h</a></td><td> | </td><td class="num">27</td><td><span class="i">++++++++++++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h56">src/vendor/re2/util/stringpiece.cc</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">src/vendor/re2/util/stringprintf.cc</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">src/vendor/re2/util/test.cc</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">src/vendor/re2/util/test.h</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="A">A</td><td><a href="#h60">src/vendor/re2/util/threadwin.cc</a></td><td> | </td><td class="num">49</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h61">src/vendor/re2/util/util.h</a></td><td> | </td><td class="num">24</td><td><span class="i">++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h62">src/vendor/re2/util/valgrind.cc</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h63">src/vendor/update.sh</a></td><td> | </td><td class="num">5</td><td><span class="i">++</span><span class="d">---</span></td></tr>
</table></pre><pre>64 files changed, 546 insertions(+), 188 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/src/vendor/re2/.gitignore">src/vendor/re2/.gitignore</a> b/<a href="../file/src/vendor/re2/.gitignore">src/vendor/re2/.gitignore</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -0,0 +1,4 @@
</a><a href="#h0-0-0" id="h0-0-0" class="i">+*.pyc
</a><a href="#h0-0-1" id="h0-0-1" class="i">+*.orig
</a><a href="#h0-0-2" id="h0-0-2" class="i">+core
</a><a href="#h0-0-3" id="h0-0-3" class="i">+obj/
</a><b>diff --git a/<a id="h1" href="../file/src/vendor/re2/.hg_archival.txt">src/vendor/re2/.hg_archival.txt</a> b/<a href="../file/src/vendor/re2/.hg_archival.txt">src/vendor/re2/.hg_archival.txt</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -1,5 +0,0 @@
</a><a href="#h1-0-0" id="h1-0-0" class="d">-repo: 166b9c1905c7b1bd26a20cbf2f5c1f66823af1c0
</a><a href="#h1-0-1" id="h1-0-1" class="d">-node: 1b483548272e6c1c31b2d16f258c2fc6bd47eca7
</a><a href="#h1-0-2" id="h1-0-2" class="d">-branch: default
</a><a href="#h1-0-3" id="h1-0-3" class="d">-latesttag: null
</a><a href="#h1-0-4" id="h1-0-4" class="d">-latesttagdistance: 119
</a><b>diff --git a/<a id="h2" href="../file/src/vendor/re2/.hgignore">src/vendor/re2/.hgignore</a> b/<a href="../file/src/vendor/re2/.hgignore">src/vendor/re2/.hgignore</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -1,7 +0,0 @@
</a><a href="#h2-0-0" id="h2-0-0" class="d">-syntax:glob
</a><a href="#h2-0-1" id="h2-0-1" class="d">-*.pyc
</a><a href="#h2-0-2" id="h2-0-2" class="d">-*.orig
</a><a href="#h2-0-3" id="h2-0-3" class="d">-core
</a><a href="#h2-0-4" id="h2-0-4" class="d">-
</a><a href="#h2-0-5" id="h2-0-5" class="d">-syntax:regexp
</a><a href="#h2-0-6" id="h2-0-6" class="d">-^obj/
</a><b>diff --git a/<a id="h3" href="../file/src/vendor/re2/CONTRIBUTING.md">src/vendor/re2/CONTRIBUTING.md</a> b/<a href="../file/src/vendor/re2/CONTRIBUTING.md">src/vendor/re2/CONTRIBUTING.md</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -0,0 +1,2 @@
</a><a href="#h3-0-0" id="h3-0-0" class="i">+RE2 uses Gerrit instead of GitHub pull requests.
</a><a href="#h3-0-1" id="h3-0-1" class="i">+See the [Contributing](https://github.com/google/re2/wiki/Contribute) wiki page.
</a><b>diff --git a/<a id="h4" href="../file/src/vendor/re2/Makefile">src/vendor/re2/Makefile</a> b/<a href="../file/src/vendor/re2/Makefile">src/vendor/re2/Makefile</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -11,7 +11,7 @@ all: obj/libre2.a obj/so/libre2.so
</a> 
 CXX?=g++
 CXXFLAGS?=-Wall -O3 -g -pthread # can override
<a href="#h4-0-3" id="h4-0-3" class="d">-RE2_CXXFLAGS?=-Wno-sign-compare -c -I. $(CCPCRE)  # required
</a><a href="#h4-0-4" id="h4-0-4" class="i">+RE2_CXXFLAGS?=-Wsign-compare -c -I. $(CCPCRE)  # required
</a> LDFLAGS?=
 AR?=ar
 ARFLAGS?=rsc
<b>diff --git a/<a id="h5" href="../file/src/vendor/re2/lib/git/commit-msg.hook">src/vendor/re2/lib/git/commit-msg.hook</a> b/<a href="../file/src/vendor/re2/lib/git/commit-msg.hook">src/vendor/re2/lib/git/commit-msg.hook</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -0,0 +1,104 @@
</a><a href="#h5-0-0" id="h5-0-0" class="i">+#!/bin/sh
</a><a href="#h5-0-1" id="h5-0-1" class="i">+# From Gerrit Code Review 2.2.1
</a><a href="#h5-0-2" id="h5-0-2" class="i">+#
</a><a href="#h5-0-3" id="h5-0-3" class="i">+# Part of Gerrit Code Review (http://code.google.com/p/gerrit/)
</a><a href="#h5-0-4" id="h5-0-4" class="i">+#
</a><a href="#h5-0-5" id="h5-0-5" class="i">+# Copyright (C) 2009 The Android Open Source Project
</a><a href="#h5-0-6" id="h5-0-6" class="i">+#
</a><a href="#h5-0-7" id="h5-0-7" class="i">+# Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
</a><a href="#h5-0-8" id="h5-0-8" class="i">+# you may not use this file except in compliance with the License.
</a><a href="#h5-0-9" id="h5-0-9" class="i">+# You may obtain a copy of the License at
</a><a href="#h5-0-10" id="h5-0-10" class="i">+#
</a><a href="#h5-0-11" id="h5-0-11" class="i">+# http://www.apache.org/licenses/LICENSE-2.0
</a><a href="#h5-0-12" id="h5-0-12" class="i">+#
</a><a href="#h5-0-13" id="h5-0-13" class="i">+# Unless required by applicable law or agreed to in writing, software
</a><a href="#h5-0-14" id="h5-0-14" class="i">+# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
</a><a href="#h5-0-15" id="h5-0-15" class="i">+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
</a><a href="#h5-0-16" id="h5-0-16" class="i">+# See the License for the specific language governing permissions and
</a><a href="#h5-0-17" id="h5-0-17" class="i">+# limitations under the License.
</a><a href="#h5-0-18" id="h5-0-18" class="i">+#
</a><a href="#h5-0-19" id="h5-0-19" class="i">+
</a><a href="#h5-0-20" id="h5-0-20" class="i">+CHANGE_ID_AFTER=&quot;Bug|Issue&quot;
</a><a href="#h5-0-21" id="h5-0-21" class="i">+MSG=&quot;$1&quot;
</a><a href="#h5-0-22" id="h5-0-22" class="i">+
</a><a href="#h5-0-23" id="h5-0-23" class="i">+# Check for, and add if missing, a unique Change-Id
</a><a href="#h5-0-24" id="h5-0-24" class="i">+#
</a><a href="#h5-0-25" id="h5-0-25" class="i">+add_ChangeId() {
</a><a href="#h5-0-26" id="h5-0-26" class="i">+	clean_message=`sed -e &#39;
</a><a href="#h5-0-27" id="h5-0-27" class="i">+		/^diff --git a\/.*/{
</a><a href="#h5-0-28" id="h5-0-28" class="i">+			s///
</a><a href="#h5-0-29" id="h5-0-29" class="i">+			q
</a><a href="#h5-0-30" id="h5-0-30" class="i">+		}
</a><a href="#h5-0-31" id="h5-0-31" class="i">+		/^Signed-off-by:/d
</a><a href="#h5-0-32" id="h5-0-32" class="i">+		/^#/d
</a><a href="#h5-0-33" id="h5-0-33" class="i">+	&#39; &quot;$MSG&quot; | git stripspace`
</a><a href="#h5-0-34" id="h5-0-34" class="i">+	if test -z &quot;$clean_message&quot;
</a><a href="#h5-0-35" id="h5-0-35" class="i">+	then
</a><a href="#h5-0-36" id="h5-0-36" class="i">+		return
</a><a href="#h5-0-37" id="h5-0-37" class="i">+	fi
</a><a href="#h5-0-38" id="h5-0-38" class="i">+
</a><a href="#h5-0-39" id="h5-0-39" class="i">+	if grep -i &#39;^Change-Id:&#39; &quot;$MSG&quot; &gt;/dev/null
</a><a href="#h5-0-40" id="h5-0-40" class="i">+	then
</a><a href="#h5-0-41" id="h5-0-41" class="i">+		return
</a><a href="#h5-0-42" id="h5-0-42" class="i">+	fi
</a><a href="#h5-0-43" id="h5-0-43" class="i">+
</a><a href="#h5-0-44" id="h5-0-44" class="i">+	id=`_gen_ChangeId`
</a><a href="#h5-0-45" id="h5-0-45" class="i">+	perl -e &#39;
</a><a href="#h5-0-46" id="h5-0-46" class="i">+		$MSG = shift;
</a><a href="#h5-0-47" id="h5-0-47" class="i">+		$id = shift;
</a><a href="#h5-0-48" id="h5-0-48" class="i">+		$CHANGE_ID_AFTER = shift;
</a><a href="#h5-0-49" id="h5-0-49" class="i">+
</a><a href="#h5-0-50" id="h5-0-50" class="i">+		undef $/;
</a><a href="#h5-0-51" id="h5-0-51" class="i">+		open(I, $MSG); $_ = &lt;I&gt;; close I;
</a><a href="#h5-0-52" id="h5-0-52" class="i">+		s|^diff --git a/.*||ms;
</a><a href="#h5-0-53" id="h5-0-53" class="i">+		s|^#.*$||mg;
</a><a href="#h5-0-54" id="h5-0-54" class="i">+		exit unless $_;
</a><a href="#h5-0-55" id="h5-0-55" class="i">+
</a><a href="#h5-0-56" id="h5-0-56" class="i">+		@message = split /\n/;
</a><a href="#h5-0-57" id="h5-0-57" class="i">+		$haveFooter = 0;
</a><a href="#h5-0-58" id="h5-0-58" class="i">+		$startFooter = @message;
</a><a href="#h5-0-59" id="h5-0-59" class="i">+		for($line = @message - 1; $line &gt;= 0; $line--) {
</a><a href="#h5-0-60" id="h5-0-60" class="i">+			$_ = $message[$line];
</a><a href="#h5-0-61" id="h5-0-61" class="i">+
</a><a href="#h5-0-62" id="h5-0-62" class="i">+			if (/^[a-zA-Z0-9-]+:/ &amp;&amp; !m,^[a-z0-9-]+://,) {
</a><a href="#h5-0-63" id="h5-0-63" class="i">+				$haveFooter++;
</a><a href="#h5-0-64" id="h5-0-64" class="i">+				next;
</a><a href="#h5-0-65" id="h5-0-65" class="i">+			}
</a><a href="#h5-0-66" id="h5-0-66" class="i">+			next if /^[ []/;
</a><a href="#h5-0-67" id="h5-0-67" class="i">+			$startFooter = $line if ($haveFooter &amp;&amp; /^\r?$/);
</a><a href="#h5-0-68" id="h5-0-68" class="i">+			last;
</a><a href="#h5-0-69" id="h5-0-69" class="i">+		}
</a><a href="#h5-0-70" id="h5-0-70" class="i">+
</a><a href="#h5-0-71" id="h5-0-71" class="i">+		@footer = @message[$startFooter+1..@message];
</a><a href="#h5-0-72" id="h5-0-72" class="i">+		@message = @message[0..$startFooter];
</a><a href="#h5-0-73" id="h5-0-73" class="i">+		push(@footer, &quot;&quot;) unless @footer;
</a><a href="#h5-0-74" id="h5-0-74" class="i">+
</a><a href="#h5-0-75" id="h5-0-75" class="i">+		for ($line = 0; $line &lt; @footer; $line++) {
</a><a href="#h5-0-76" id="h5-0-76" class="i">+			$_ = $footer[$line];
</a><a href="#h5-0-77" id="h5-0-77" class="i">+			next if /^($CHANGE_ID_AFTER):/i;
</a><a href="#h5-0-78" id="h5-0-78" class="i">+			last;
</a><a href="#h5-0-79" id="h5-0-79" class="i">+		}
</a><a href="#h5-0-80" id="h5-0-80" class="i">+		splice(@footer, $line, 0, &quot;Change-Id: I$id&quot;);
</a><a href="#h5-0-81" id="h5-0-81" class="i">+
</a><a href="#h5-0-82" id="h5-0-82" class="i">+		$_ = join(&quot;\n&quot;, @message, @footer);
</a><a href="#h5-0-83" id="h5-0-83" class="i">+		open(O, &quot;&gt;$MSG&quot;); print O; close O;
</a><a href="#h5-0-84" id="h5-0-84" class="i">+	&#39; &quot;$MSG&quot; &quot;$id&quot; &quot;$CHANGE_ID_AFTER&quot;
</a><a href="#h5-0-85" id="h5-0-85" class="i">+}
</a><a href="#h5-0-86" id="h5-0-86" class="i">+_gen_ChangeIdInput() {
</a><a href="#h5-0-87" id="h5-0-87" class="i">+	echo &quot;tree `git write-tree`&quot;
</a><a href="#h5-0-88" id="h5-0-88" class="i">+	if parent=`git rev-parse HEAD^0 2&gt;/dev/null`
</a><a href="#h5-0-89" id="h5-0-89" class="i">+	then
</a><a href="#h5-0-90" id="h5-0-90" class="i">+		echo &quot;parent $parent&quot;
</a><a href="#h5-0-91" id="h5-0-91" class="i">+	fi
</a><a href="#h5-0-92" id="h5-0-92" class="i">+	echo &quot;author `git var GIT_AUTHOR_IDENT`&quot;
</a><a href="#h5-0-93" id="h5-0-93" class="i">+	echo &quot;committer `git var GIT_COMMITTER_IDENT`&quot;
</a><a href="#h5-0-94" id="h5-0-94" class="i">+	echo
</a><a href="#h5-0-95" id="h5-0-95" class="i">+	printf &#39;%s&#39; &quot;$clean_message&quot;
</a><a href="#h5-0-96" id="h5-0-96" class="i">+}
</a><a href="#h5-0-97" id="h5-0-97" class="i">+_gen_ChangeId() {
</a><a href="#h5-0-98" id="h5-0-98" class="i">+	_gen_ChangeIdInput |
</a><a href="#h5-0-99" id="h5-0-99" class="i">+	git hash-object -t commit --stdin
</a><a href="#h5-0-100" id="h5-0-100" class="i">+}
</a><a href="#h5-0-101" id="h5-0-101" class="i">+
</a><a href="#h5-0-102" id="h5-0-102" class="i">+
</a><a href="#h5-0-103" id="h5-0-103" class="i">+add_ChangeId
</a><b>diff --git a/<a id="h6" href="../file/src/vendor/re2/re2/bitstate.cc">src/vendor/re2/re2/bitstate.cc</a> b/<a href="../file/src/vendor/re2/re2/bitstate.cc">src/vendor/re2/re2/bitstate.cc</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -170,6 +170,8 @@ bool BitState::TrySearch(int id0, const char* p0) {
</a>     Prog::Inst* ip = prog_-&gt;inst(id);
     switch (ip-&gt;opcode()) {
       case kInstFail:
<a href="#h6-0-3" id="h6-0-3" class="i">+        return false;
</a><a href="#h6-0-4" id="h6-0-4" class="i">+
</a>       default:
         LOG(DFATAL) &lt;&lt; &quot;Unexpected opcode: &quot; &lt;&lt; ip-&gt;opcode() &lt;&lt; &quot; arg &quot; &lt;&lt; arg;
         return false;
<b>diff --git a/<a id="h7" href="../file/src/vendor/re2/re2/compile.cc">src/vendor/re2/re2/compile.cc</a> b/<a href="../file/src/vendor/re2/re2/compile.cc">src/vendor/re2/re2/compile.cc</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -230,7 +230,7 @@ class Compiler : public Regexp::Walker&lt;Frag&gt; {
</a> 
   RE2::Anchor anchor_;  // anchor mode for RE2::Set
 
<a href="#h7-0-3" id="h7-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(Compiler);
</a><a href="#h7-0-4" id="h7-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(Compiler);
</a> };
 
 Compiler::Compiler() {
<a href="#h7-1" id="h7-1" class="h">@@ -958,7 +958,7 @@ void Compiler::Setup(Regexp::ParseFlags flags, int64 max_mem,
</a>   max_mem_ = max_mem;
   if (max_mem &lt;= 0) {
     max_inst_ = 100000;  // more than enough
<a href="#h7-1-3" id="h7-1-3" class="d">-  } else if (max_mem &lt;= sizeof(Prog)) {
</a><a href="#h7-1-4" id="h7-1-4" class="i">+  } else if (max_mem &lt;= static_cast&lt;int64&gt;(sizeof(Prog))) {
</a>     // No room for anything.
     max_inst_ = 0;
   } else {
<b>diff --git a/<a id="h8" href="../file/src/vendor/re2/re2/dfa.cc">src/vendor/re2/re2/dfa.cc</a> b/<a href="../file/src/vendor/re2/re2/dfa.cc">src/vendor/re2/re2/dfa.cc</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -275,7 +275,7 @@ class DFA {
</a>     vector&lt;int&gt;* matches;
 
    private:
<a href="#h8-0-3" id="h8-0-3" class="d">-    DISALLOW_EVIL_CONSTRUCTORS(SearchParams);
</a><a href="#h8-0-4" id="h8-0-4" class="i">+    DISALLOW_COPY_AND_ASSIGN(SearchParams);
</a>   };
 
   // Before each search, the parameters to Search are analyzed by
<a href="#h8-1" id="h8-1" class="h">@@ -428,7 +428,7 @@ class DFA::Workq : public SparseSet {
</a>   int maxmark_;          // maximum number of marks
   int nextmark_;         // id of next mark
   bool last_was_mark_;   // last inserted was mark
<a href="#h8-1-3" id="h8-1-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(Workq);
</a><a href="#h8-1-4" id="h8-1-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(Workq);
</a> };
 
 DFA::DFA(Prog* prog, Prog::MatchKind kind, int64 max_mem)
<a href="#h8-2" id="h8-2" class="h">@@ -787,7 +787,7 @@ void DFA::ClearCache() {
</a>        it != state_cache_.end(); ++it)
     v.push_back(*it);
   state_cache_.clear();
<a href="#h8-2-3" id="h8-2-3" class="d">-  for (int i = 0; i &lt; v.size(); i++)
</a><a href="#h8-2-4" id="h8-2-4" class="i">+  for (size_t i = 0; i &lt; v.size(); i++)
</a>     delete[] reinterpret_cast&lt;const char*&gt;(v[i]);
 }
 
<a href="#h8-3" id="h8-3" class="h">@@ -1102,7 +1102,7 @@ class DFA::RWLocker {
</a>   Mutex* mu_;
   bool writing_;
 
<a href="#h8-3-3" id="h8-3-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(RWLocker);
</a><a href="#h8-3-4" id="h8-3-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(RWLocker);
</a> };
 
 DFA::RWLocker::RWLocker(Mutex* mu)
<a href="#h8-4" id="h8-4" class="h">@@ -1202,7 +1202,7 @@ class DFA::StateSaver {
</a>   bool is_special_;  // whether original state was special
   State* special_;   // if is_special_, the original state
 
<a href="#h8-4-3" id="h8-4-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(StateSaver);
</a><a href="#h8-4-4" id="h8-4-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(StateSaver);
</a> };
 
 DFA::StateSaver::StateSaver(DFA* dfa, State* state) {
<a href="#h8-5" id="h8-5" class="h">@@ -1394,7 +1394,7 @@ inline bool DFA::InlinedSearchLoop(SearchParams* params,
</a>         // of 10 bytes per state computation, fail so that RE2 can
         // fall back to the NFA.
         if (FLAGS_re2_dfa_bail_when_slow &amp;&amp; resetp != NULL &amp;&amp;
<a href="#h8-5-3" id="h8-5-3" class="d">-            (p - resetp) &lt; 10*state_cache_.size()) {
</a><a href="#h8-5-4" id="h8-5-4" class="i">+            static_cast&lt;unsigned long&gt;(p - resetp) &lt; 10*state_cache_.size()) {
</a>           params-&gt;failed = true;
           return false;
         }
<a href="#h8-6" id="h8-6" class="h">@@ -1932,7 +1932,7 @@ int DFA::BuildAllStates() {
</a>   q.push_back(params.start);
 
   // Flood to expand every state.
<a href="#h8-6-3" id="h8-6-3" class="d">-  for (int i = 0; i &lt; q.size(); i++) {
</a><a href="#h8-6-4" id="h8-6-4" class="i">+  for (size_t i = 0; i &lt; q.size(); i++) {
</a>     State* s = q[i];
     for (int c = 0; c &lt; 257; c++) {
       State* ns = RunStateOnByteUnlocked(s, c);
<a href="#h8-7" id="h8-7" class="h">@@ -2015,6 +2015,7 @@ bool DFA::PossibleMatchRange(string* min, string* max, int maxlen) {
</a>   // Build minimum prefix.
   State* s = params.start;
   min-&gt;clear();
<a href="#h8-7-3" id="h8-7-3" class="i">+  MutexLock lock(&amp;mutex_);
</a>   for (int i = 0; i &lt; maxlen; i++) {
     if (previously_visited_states[s] &gt; kMaxEltRepetitions) {
       VLOG(2) &lt;&lt; &quot;Hit kMaxEltRepetitions=&quot; &lt;&lt; kMaxEltRepetitions
<a href="#h8-8" id="h8-8" class="h">@@ -2024,7 +2025,7 @@ bool DFA::PossibleMatchRange(string* min, string* max, int maxlen) {
</a>     previously_visited_states[s]++;
 
     // Stop if min is a match.
<a href="#h8-8-3" id="h8-8-3" class="d">-    State* ns = RunStateOnByteUnlocked(s, kByteEndText);
</a><a href="#h8-8-4" id="h8-8-4" class="i">+    State* ns = RunStateOnByte(s, kByteEndText);
</a>     if (ns == NULL)  // DFA out of memory
       return false;
     if (ns != DeadState &amp;&amp; (ns == FullMatchState || ns-&gt;IsMatch()))
<a href="#h8-9" id="h8-9" class="h">@@ -2033,7 +2034,7 @@ bool DFA::PossibleMatchRange(string* min, string* max, int maxlen) {
</a>     // Try to extend the string with low bytes.
     bool extended = false;
     for (int j = 0; j &lt; 256; j++) {
<a href="#h8-9-3" id="h8-9-3" class="d">-      ns = RunStateOnByteUnlocked(s, j);
</a><a href="#h8-9-4" id="h8-9-4" class="i">+      ns = RunStateOnByte(s, j);
</a>       if (ns == NULL)  // DFA out of memory
         return false;
       if (ns == FullMatchState ||
<a href="#h8-10" id="h8-10" class="h">@@ -2063,7 +2064,7 @@ bool DFA::PossibleMatchRange(string* min, string* max, int maxlen) {
</a>     // Try to extend the string with high bytes.
     bool extended = false;
     for (int j = 255; j &gt;= 0; j--) {
<a href="#h8-10-3" id="h8-10-3" class="d">-      State* ns = RunStateOnByteUnlocked(s, j);
</a><a href="#h8-10-4" id="h8-10-4" class="i">+      State* ns = RunStateOnByte(s, j);
</a>       if (ns == NULL)
         return false;
       if (ns == FullMatchState ||
<b>diff --git a/<a id="h9" href="../file/src/vendor/re2/re2/filtered_re2.cc">src/vendor/re2/re2/filtered_re2.cc</a> b/<a href="../file/src/vendor/re2/re2/filtered_re2.cc">src/vendor/re2/re2/filtered_re2.cc</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -16,7 +16,7 @@ FilteredRE2::FilteredRE2()
</a> }
 
 FilteredRE2::~FilteredRE2() {
<a href="#h9-0-3" id="h9-0-3" class="d">-  for (int i = 0; i &lt; re2_vec_.size(); i++)
</a><a href="#h9-0-4" id="h9-0-4" class="i">+  for (size_t i = 0; i &lt; re2_vec_.size(); i++)
</a>     delete re2_vec_[i];
   delete prefilter_tree_;
 }
<a href="#h9-1" id="h9-1" class="h">@@ -46,7 +46,7 @@ void FilteredRE2::Compile(vector&lt;string&gt;* atoms) {
</a>     return;
   }
 
<a href="#h9-1-3" id="h9-1-3" class="d">-  for (int i = 0; i &lt; re2_vec_.size(); i++) {
</a><a href="#h9-1-4" id="h9-1-4" class="i">+  for (size_t i = 0; i &lt; re2_vec_.size(); i++) {
</a>     Prefilter* prefilter = Prefilter::FromRE2(re2_vec_[i]);
     prefilter_tree_-&gt;Add(prefilter);
   }
<a href="#h9-2" id="h9-2" class="h">@@ -56,7 +56,7 @@ void FilteredRE2::Compile(vector&lt;string&gt;* atoms) {
</a> }
 
 int FilteredRE2::SlowFirstMatch(const StringPiece&amp; text) const {
<a href="#h9-2-3" id="h9-2-3" class="d">-  for (int i = 0; i &lt; re2_vec_.size(); i++)
</a><a href="#h9-2-4" id="h9-2-4" class="i">+  for (size_t i = 0; i &lt; re2_vec_.size(); i++)
</a>     if (RE2::PartialMatch(text, *re2_vec_[i]))
       return i;
   return -1;
<a href="#h9-3" id="h9-3" class="h">@@ -70,7 +70,7 @@ int FilteredRE2::FirstMatch(const StringPiece&amp; text,
</a>   }
   vector&lt;int&gt; regexps;
   prefilter_tree_-&gt;RegexpsGivenStrings(atoms, &amp;regexps);
<a href="#h9-3-3" id="h9-3-3" class="d">-  for (int i = 0; i &lt; regexps.size(); i++)
</a><a href="#h9-3-4" id="h9-3-4" class="i">+  for (size_t i = 0; i &lt; regexps.size(); i++)
</a>     if (RE2::PartialMatch(text, *re2_vec_[regexps[i]]))
       return regexps[i];
   return -1;
<a href="#h9-4" id="h9-4" class="h">@@ -83,18 +83,23 @@ bool FilteredRE2::AllMatches(
</a>   matching_regexps-&gt;clear();
   vector&lt;int&gt; regexps;
   prefilter_tree_-&gt;RegexpsGivenStrings(atoms, &amp;regexps);
<a href="#h9-4-3" id="h9-4-3" class="d">-  for (int i = 0; i &lt; regexps.size(); i++)
</a><a href="#h9-4-4" id="h9-4-4" class="i">+  for (size_t i = 0; i &lt; regexps.size(); i++)
</a>     if (RE2::PartialMatch(text, *re2_vec_[regexps[i]]))
       matching_regexps-&gt;push_back(regexps[i]);
   return !matching_regexps-&gt;empty();
 }
 
<a href="#h9-4-10" id="h9-4-10" class="i">+void FilteredRE2::AllPotentials(
</a><a href="#h9-4-11" id="h9-4-11" class="i">+    const vector&lt;int&gt;&amp; atoms,
</a><a href="#h9-4-12" id="h9-4-12" class="i">+    vector&lt;int&gt;* potential_regexps) const {
</a><a href="#h9-4-13" id="h9-4-13" class="i">+  prefilter_tree_-&gt;RegexpsGivenStrings(atoms, potential_regexps);
</a><a href="#h9-4-14" id="h9-4-14" class="i">+}
</a><a href="#h9-4-15" id="h9-4-15" class="i">+
</a> void FilteredRE2::RegexpsGivenStrings(const vector&lt;int&gt;&amp; matched_atoms,
                                       vector&lt;int&gt;* passed_regexps) {
   prefilter_tree_-&gt;RegexpsGivenStrings(matched_atoms, passed_regexps);
 }
 
<a href="#h9-4-21" id="h9-4-21" class="d">-
</a> void FilteredRE2::PrintPrefilter(int regexpid) {
   prefilter_tree_-&gt;PrintPrefilter(regexpid);
 }
<b>diff --git a/<a id="h10" href="../file/src/vendor/re2/re2/filtered_re2.h">src/vendor/re2/re2/filtered_re2.h</a> b/<a href="../file/src/vendor/re2/re2/filtered_re2.h">src/vendor/re2/re2/filtered_re2.h</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -67,6 +67,14 @@ class FilteredRE2 {
</a>                   const vector&lt;int&gt;&amp; atoms,
                   vector&lt;int&gt;* matching_regexps) const;
 
<a href="#h10-0-3" id="h10-0-3" class="i">+  // Returns the indices of all potentially matching regexps after first
</a><a href="#h10-0-4" id="h10-0-4" class="i">+  // clearing potential_regexps.
</a><a href="#h10-0-5" id="h10-0-5" class="i">+  // A regexp is potentially matching if it passes the filter.
</a><a href="#h10-0-6" id="h10-0-6" class="i">+  // If a regexp passes the filter it may still not match.
</a><a href="#h10-0-7" id="h10-0-7" class="i">+  // A regexp that does not pass the filter is guaranteed to not match.
</a><a href="#h10-0-8" id="h10-0-8" class="i">+  void AllPotentials(const vector&lt;int&gt;&amp; atoms,
</a><a href="#h10-0-9" id="h10-0-9" class="i">+                     vector&lt;int&gt;* potential_regexps) const;
</a><a href="#h10-0-10" id="h10-0-10" class="i">+
</a>   // The number of regexps added.
   int NumRegexps() const { return re2_vec_.size(); }
 
<a href="#h10-1" id="h10-1" class="h">@@ -91,7 +99,7 @@ class FilteredRE2 {
</a>   // An AND-OR tree of string atoms used for filtering regexps.
   PrefilterTree* prefilter_tree_;
 
<a href="#h10-1-3" id="h10-1-3" class="d">-  //DISALLOW_EVIL_CONSTRUCTORS(FilteredRE2);
</a><a href="#h10-1-4" id="h10-1-4" class="i">+  //DISALLOW_COPY_AND_ASSIGN(FilteredRE2);
</a>   FilteredRE2(const FilteredRE2&amp;);
   void operator=(const FilteredRE2&amp;);
 };
<b>diff --git a/<a id="h11" href="../file/src/vendor/re2/re2/mimics_pcre.cc">src/vendor/re2/re2/mimics_pcre.cc</a> b/<a href="../file/src/vendor/re2/re2/mimics_pcre.cc">src/vendor/re2/re2/mimics_pcre.cc</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -124,7 +124,7 @@ class EmptyStringWalker : public Regexp::Walker&lt;bool&gt; {
</a>   }
 
  private:
<a href="#h11-0-3" id="h11-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(EmptyStringWalker);
</a><a href="#h11-0-4" id="h11-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(EmptyStringWalker);
</a> };
 
 // Called after visiting re&#39;s children.  child_args contains the return
<b>diff --git a/<a id="h12" href="../file/src/vendor/re2/re2/nfa.cc">src/vendor/re2/re2/nfa.cc</a> b/<a href="../file/src/vendor/re2/re2/nfa.cc">src/vendor/re2/re2/nfa.cc</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -122,7 +122,7 @@ class NFA {
</a> 
   Thread* free_threads_;  // free list
 
<a href="#h12-0-3" id="h12-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(NFA);
</a><a href="#h12-0-4" id="h12-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(NFA);
</a> };
 
 NFA::NFA(Prog* prog) {
<a href="#h12-1" id="h12-1" class="h">@@ -529,7 +529,8 @@ bool NFA::Search(const StringPiece&amp; text, const StringPiece&amp; const_context,
</a>             break;
 
           case kInstCapture:
<a href="#h12-1-3" id="h12-1-3" class="d">-            match_[ip-&gt;cap()] = p;
</a><a href="#h12-1-4" id="h12-1-4" class="i">+            if (ip-&gt;cap() &lt; ncapture_)
</a><a href="#h12-1-5" id="h12-1-5" class="i">+              match_[ip-&gt;cap()] = p;
</a>             id = ip-&gt;out();
             continue;
 
<b>diff --git a/<a id="h13" href="../file/src/vendor/re2/re2/parse.cc">src/vendor/re2/re2/parse.cc</a> b/<a href="../file/src/vendor/re2/re2/parse.cc">src/vendor/re2/re2/parse.cc</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -156,7 +156,7 @@ private:
</a>   int ncap_;  // number of capturing parens seen
   int rune_max_;  // maximum char value for this encoding
 
<a href="#h13-0-3" id="h13-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(ParseState);
</a><a href="#h13-0-4" id="h13-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(ParseState);
</a> };
 
 // Pseudo-operators - only on parse stack.
<a href="#h13-1" id="h13-1" class="h">@@ -1188,6 +1188,14 @@ static int StringPieceToRune(Rune *r, StringPiece *sp, RegexpStatus* status) {
</a>   int n;
   if (fullrune(sp-&gt;data(), sp-&gt;size())) {
     n = chartorune(r, sp-&gt;data());
<a href="#h13-1-3" id="h13-1-3" class="i">+    // Some copies of chartorune have a bug that accepts
</a><a href="#h13-1-4" id="h13-1-4" class="i">+    // encodings of values in (10FFFF, 1FFFFF] as valid.
</a><a href="#h13-1-5" id="h13-1-5" class="i">+    // Those values break the character class algorithm,
</a><a href="#h13-1-6" id="h13-1-6" class="i">+    // which assumes Runemax is the largest rune.
</a><a href="#h13-1-7" id="h13-1-7" class="i">+    if (*r &gt; Runemax) {
</a><a href="#h13-1-8" id="h13-1-8" class="i">+      n = 1;
</a><a href="#h13-1-9" id="h13-1-9" class="i">+      *r = Runeerror;
</a><a href="#h13-1-10" id="h13-1-10" class="i">+    }
</a>     if (!(n == 1 &amp;&amp; *r == Runeerror)) {  // no decoding error
       sp-&gt;remove_prefix(n);
       return n;
<a href="#h13-2" id="h13-2" class="h">@@ -1539,7 +1547,7 @@ ParseStatus ParseUnicodeGroup(StringPiece* s, Regexp::ParseFlags parse_flags,
</a>     name = StringPiece(p, s-&gt;begin() - p);
   } else {
     // Name is in braces. Look for closing }
<a href="#h13-2-3" id="h13-2-3" class="d">-    int end = s-&gt;find(&#39;}&#39;, 0);
</a><a href="#h13-2-4" id="h13-2-4" class="i">+    size_t end = s-&gt;find(&#39;}&#39;, 0);
</a>     if (end == s-&gt;npos) {
       if (!IsValidUTF8(seq, status))
         return kParseError;
<a href="#h13-3" id="h13-3" class="h">@@ -1822,7 +1830,7 @@ bool Regexp::ParseState::ParsePerlFlags(StringPiece* s) {
</a>   // so that&#39;s the one we implement.  One is enough.
   if (t.size() &gt; 2 &amp;&amp; t[0] == &#39;P&#39; &amp;&amp; t[1] == &#39;&lt;&#39;) {
     // Pull out name.
<a href="#h13-3-3" id="h13-3-3" class="d">-    int end = t.find(&#39;&gt;&#39;, 2);
</a><a href="#h13-3-4" id="h13-3-4" class="i">+    size_t end = t.find(&#39;&gt;&#39;, 2);
</a>     if (end == t.npos) {
       if (!IsValidUTF8(*s, status_))
         return false;
<b>diff --git a/<a id="h14" href="../file/src/vendor/re2/re2/prefilter.cc">src/vendor/re2/re2/prefilter.cc</a> b/<a href="../file/src/vendor/re2/re2/prefilter.cc">src/vendor/re2/re2/prefilter.cc</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -31,7 +31,7 @@ Prefilter::Prefilter(Op op) {
</a> Prefilter::~Prefilter() {
   VLOG(10) &lt;&lt; &quot;Deleted: &quot; &lt;&lt; alloc_id_;
   if (subs_) {
<a href="#h14-0-3" id="h14-0-3" class="d">-    for (int i = 0; i &lt; subs_-&gt;size(); i++)
</a><a href="#h14-0-4" id="h14-0-4" class="i">+    for (size_t i = 0; i &lt; subs_-&gt;size(); i++)
</a>       delete (*subs_)[i];
     delete subs_;
     subs_ = NULL;
<a href="#h14-1" id="h14-1" class="h">@@ -100,7 +100,7 @@ Prefilter* Prefilter::AndOr(Op op, Prefilter* a, Prefilter* b) {
</a> 
   // If a and b match op, merge their contents.
   if (a-&gt;op() == op &amp;&amp; b-&gt;op() == op) {
<a href="#h14-1-3" id="h14-1-3" class="d">-    for (int i = 0; i &lt; b-&gt;subs()-&gt;size(); i++) {
</a><a href="#h14-1-4" id="h14-1-4" class="i">+    for (size_t i = 0; i &lt; b-&gt;subs()-&gt;size(); i++) {
</a>       Prefilter* bb = (*b-&gt;subs())[i];
       a-&gt;subs()-&gt;push_back(bb);
     }
<a href="#h14-2" id="h14-2" class="h">@@ -492,7 +492,7 @@ class Prefilter::Info::Walker : public Regexp::Walker&lt;Prefilter::Info*&gt; {
</a>   bool latin1() { return latin1_; }
  private:
   bool latin1_;
<a href="#h14-2-3" id="h14-2-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(Walker);
</a><a href="#h14-2-4" id="h14-2-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(Walker);
</a> };
 
 Prefilter::Info* Prefilter::BuildInfo(Regexp* re) {
<a href="#h14-3" id="h14-3" class="h">@@ -669,7 +669,7 @@ string Prefilter::DebugString() const {
</a>       return &quot;&quot;;
     case AND: {
       string s = &quot;&quot;;
<a href="#h14-3-3" id="h14-3-3" class="d">-      for (int i = 0; i &lt; subs_-&gt;size(); i++) {
</a><a href="#h14-3-4" id="h14-3-4" class="i">+      for (size_t i = 0; i &lt; subs_-&gt;size(); i++) {
</a>         if (i &gt; 0)
           s += &quot; &quot;;
         Prefilter* sub = (*subs_)[i];
<a href="#h14-4" id="h14-4" class="h">@@ -679,7 +679,7 @@ string Prefilter::DebugString() const {
</a>     }
     case OR: {
       string s = &quot;(&quot;;
<a href="#h14-4-3" id="h14-4-3" class="d">-      for (int i = 0; i &lt; subs_-&gt;size(); i++) {
</a><a href="#h14-4-4" id="h14-4-4" class="i">+      for (size_t i = 0; i &lt; subs_-&gt;size(); i++) {
</a>         if (i &gt; 0)
           s += &quot;|&quot;;
         Prefilter* sub = (*subs_)[i];
<b>diff --git a/<a id="h15" href="../file/src/vendor/re2/re2/prefilter.h">src/vendor/re2/re2/prefilter.h</a> b/<a href="../file/src/vendor/re2/re2/prefilter.h">src/vendor/re2/re2/prefilter.h</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -97,7 +97,7 @@ class Prefilter {
</a>   // Used for debugging, helps in tracking memory leaks.
   int alloc_id_;
 
<a href="#h15-0-3" id="h15-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(Prefilter);
</a><a href="#h15-0-4" id="h15-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(Prefilter);
</a> };
 
 }  // namespace re2
<b>diff --git a/<a id="h16" href="../file/src/vendor/re2/re2/prefilter_tree.cc">src/vendor/re2/re2/prefilter_tree.cc</a> b/<a href="../file/src/vendor/re2/re2/prefilter_tree.cc">src/vendor/re2/re2/prefilter_tree.cc</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -19,10 +19,10 @@ PrefilterTree::PrefilterTree()
</a> }
 
 PrefilterTree::~PrefilterTree() {
<a href="#h16-0-3" id="h16-0-3" class="d">-  for (int i = 0; i &lt; prefilter_vec_.size(); i++)
</a><a href="#h16-0-4" id="h16-0-4" class="i">+  for (size_t i = 0; i &lt; prefilter_vec_.size(); i++)
</a>     delete prefilter_vec_[i];
 
<a href="#h16-0-7" id="h16-0-7" class="d">-  for (int i = 0; i &lt; entries_.size(); i++)
</a><a href="#h16-0-8" id="h16-0-8" class="i">+  for (size_t i = 0; i &lt; entries_.size(); i++)
</a>     delete entries_[i].parents;
 }
 
<a href="#h16-1" id="h16-1" class="h">@@ -43,12 +43,12 @@ static bool KeepPart(Prefilter* prefilter, int level) {
</a> 
     case Prefilter::ATOM:
       return prefilter-&gt;atom().size() &gt;=
<a href="#h16-1-3" id="h16-1-3" class="d">-          FLAGS_filtered_re2_min_atom_len;
</a><a href="#h16-1-4" id="h16-1-4" class="i">+          static_cast&lt;size_t&gt;(FLAGS_filtered_re2_min_atom_len);
</a> 
     case Prefilter::AND: {
       int j = 0;
       vector&lt;Prefilter*&gt;* subs = prefilter-&gt;subs();
<a href="#h16-1-9" id="h16-1-9" class="d">-      for (int i = 0; i &lt; subs-&gt;size(); i++)
</a><a href="#h16-1-10" id="h16-1-10" class="i">+      for (size_t i = 0; i &lt; subs-&gt;size(); i++)
</a>         if (KeepPart((*subs)[i], level + 1))
           (*subs)[j++] = (*subs)[i];
         else
<a href="#h16-2" id="h16-2" class="h">@@ -59,7 +59,7 @@ static bool KeepPart(Prefilter* prefilter, int level) {
</a>     }
 
     case Prefilter::OR:
<a href="#h16-2-3" id="h16-2-3" class="d">-      for (int i = 0; i &lt; prefilter-&gt;subs()-&gt;size(); i++)
</a><a href="#h16-2-4" id="h16-2-4" class="i">+      for (size_t i = 0; i &lt; prefilter-&gt;subs()-&gt;size(); i++)
</a>         if (!KeepPart((*prefilter-&gt;subs())[i], level + 1))
           return false;
       return true;
<a href="#h16-3" id="h16-3" class="h">@@ -101,7 +101,7 @@ void PrefilterTree::Compile(vector&lt;string&gt;* atom_vec) {
</a>   // no longer necessary for their parent to trigger; that is, we do
   // not miss out on any regexps triggering by getting rid of a
   // prefilter node.
<a href="#h16-3-3" id="h16-3-3" class="d">-  for (int i = 0; i &lt; entries_.size(); i++) {
</a><a href="#h16-3-4" id="h16-3-4" class="i">+  for (size_t i = 0; i &lt; entries_.size(); i++) {
</a>     StdIntMap* parents = entries_[i].parents;
     if (parents-&gt;size() &gt; 8) {
       // This one triggers too many things. If all the parents are AND
<a href="#h16-4" id="h16-4" class="h">@@ -109,9 +109,11 @@ void PrefilterTree::Compile(vector&lt;string&gt;* atom_vec) {
</a>       // this trigger. TODO(vsri): Adjust the threshold appropriately,
       // make it a function of total number of nodes?
       bool have_other_guard = true;
<a href="#h16-4-3" id="h16-4-3" class="d">-      for (StdIntMap::iterator it = parents-&gt;begin(); it != parents-&gt;end(); ++it)
</a><a href="#h16-4-4" id="h16-4-4" class="i">+      for (StdIntMap::iterator it = parents-&gt;begin();
</a><a href="#h16-4-5" id="h16-4-5" class="i">+           it != parents-&gt;end(); ++it) {
</a>         have_other_guard = have_other_guard &amp;&amp;
             (entries_[it-&gt;first].propagate_up_at_count &gt; 1);
<a href="#h16-4-8" id="h16-4-8" class="i">+      }
</a> 
       if (have_other_guard) {
         for (StdIntMap::iterator it = parents-&gt;begin();
<a href="#h16-5" id="h16-5" class="h">@@ -146,7 +148,7 @@ string PrefilterTree::NodeString(Prefilter* node) const {
</a>   if (node-&gt;op() == Prefilter::ATOM) {
     s += node-&gt;atom();
   } else {
<a href="#h16-5-3" id="h16-5-3" class="d">-    for (int i = 0; i &lt; node-&gt;subs()-&gt;size() ; i++) {
</a><a href="#h16-5-4" id="h16-5-4" class="i">+    for (size_t i = 0; i &lt; node-&gt;subs()-&gt;size(); i++) {
</a>       if (i &gt; 0)
         s += &#39;,&#39;;
       s += Itoa((*node-&gt;subs())[i]-&gt;unique_id());
<a href="#h16-6" id="h16-6" class="h">@@ -163,7 +165,7 @@ void PrefilterTree::AssignUniqueIds(vector&lt;string&gt;* atom_vec) {
</a>   vector&lt;Prefilter*&gt; v;
 
   // Add the top level nodes of each regexp prefilter.
<a href="#h16-6-3" id="h16-6-3" class="d">-  for (int i = 0; i &lt; prefilter_vec_.size(); i++) {
</a><a href="#h16-6-4" id="h16-6-4" class="i">+  for (size_t i = 0; i &lt; prefilter_vec_.size(); i++) {
</a>     Prefilter* f = prefilter_vec_[i];
     if (f == NULL)
       unfiltered_.push_back(i);
<a href="#h16-7" id="h16-7" class="h">@@ -174,13 +176,13 @@ void PrefilterTree::AssignUniqueIds(vector&lt;string&gt;* atom_vec) {
</a>   }
 
   // Now add all the descendant nodes.
<a href="#h16-7-3" id="h16-7-3" class="d">-  for (int i = 0; i &lt; v.size(); i++) {
</a><a href="#h16-7-4" id="h16-7-4" class="i">+  for (size_t i = 0; i &lt; v.size(); i++) {
</a>     Prefilter* f = v[i];
     if (f == NULL)
       continue;
     if (f-&gt;op() == Prefilter::AND || f-&gt;op() == Prefilter::OR) {
       const vector&lt;Prefilter*&gt;&amp; subs = *f-&gt;subs();
<a href="#h16-7-10" id="h16-7-10" class="d">-      for (int j = 0; j &lt; subs.size(); j++)
</a><a href="#h16-7-11" id="h16-7-11" class="i">+      for (size_t j = 0; j &lt; subs.size(); j++)
</a>         v.push_back(subs[j]);
     }
   }
<a href="#h16-8" id="h16-8" class="h">@@ -208,7 +210,7 @@ void PrefilterTree::AssignUniqueIds(vector&lt;string&gt;* atom_vec) {
</a>   }
   entries_.resize(node_map_.size());
 
<a href="#h16-8-3" id="h16-8-3" class="d">-  // Create parent IntMap for the entries.
</a><a href="#h16-8-4" id="h16-8-4" class="i">+  // Create parent StdIntMap for the entries.
</a>   for (int i = v.size()  - 1; i &gt;= 0; i--) {
     Prefilter* prefilter = v[i];
     if (prefilter == NULL)
<a href="#h16-9" id="h16-9" class="h">@@ -245,7 +247,7 @@ void PrefilterTree::AssignUniqueIds(vector&lt;string&gt;* atom_vec) {
</a>       case Prefilter::OR:
       case Prefilter::AND: {
         set&lt;int&gt; uniq_child;
<a href="#h16-9-3" id="h16-9-3" class="d">-        for (int j = 0; j &lt; prefilter-&gt;subs()-&gt;size() ; j++) {
</a><a href="#h16-9-4" id="h16-9-4" class="i">+        for (size_t j = 0; j &lt; prefilter-&gt;subs()-&gt;size(); j++) {
</a>           Prefilter* child = (*prefilter-&gt;subs())[j];
           Prefilter* canonical = CanonicalNode(child);
           if (canonical == NULL) {
<a href="#h16-10" id="h16-10" class="h">@@ -256,8 +258,10 @@ void PrefilterTree::AssignUniqueIds(vector&lt;string&gt;* atom_vec) {
</a>           uniq_child.insert(child_id);
           // To the child, we want to add to parent indices.
           Entry* child_entry = &amp;entries_[child_id];
<a href="#h16-10-3" id="h16-10-3" class="d">-          if (child_entry-&gt;parents-&gt;find(prefilter-&gt;unique_id()) == child_entry-&gt;parents-&gt;end())
</a><a href="#h16-10-4" id="h16-10-4" class="i">+          if (child_entry-&gt;parents-&gt;find(prefilter-&gt;unique_id()) ==
</a><a href="#h16-10-5" id="h16-10-5" class="i">+              child_entry-&gt;parents-&gt;end()) {
</a>             (*child_entry-&gt;parents)[prefilter-&gt;unique_id()] = 1;
<a href="#h16-10-7" id="h16-10-7" class="i">+          }
</a>         }
         entry-&gt;propagate_up_at_count =
             prefilter-&gt;op() == Prefilter::AND ? uniq_child.size() : 1;
<a href="#h16-11" id="h16-11" class="h">@@ -268,7 +272,7 @@ void PrefilterTree::AssignUniqueIds(vector&lt;string&gt;* atom_vec) {
</a>   }
 
   // For top level nodes, populate regexp id.
<a href="#h16-11-3" id="h16-11-3" class="d">-  for (int i = 0; i &lt; prefilter_vec_.size(); i++) {
</a><a href="#h16-11-4" id="h16-11-4" class="i">+  for (size_t i = 0; i &lt; prefilter_vec_.size(); i++) {
</a>     if (prefilter_vec_[i] == NULL)
       continue;
     int id = CanonicalNode(prefilter_vec_[i])-&gt;unique_id();
<a href="#h16-12" id="h16-12" class="h">@@ -285,13 +289,13 @@ void PrefilterTree::RegexpsGivenStrings(
</a>   regexps-&gt;clear();
   if (!compiled_) {
     LOG(WARNING) &lt;&lt; &quot;Compile() not called&quot;;
<a href="#h16-12-3" id="h16-12-3" class="d">-    for (int i = 0; i &lt; prefilter_vec_.size(); ++i)
</a><a href="#h16-12-4" id="h16-12-4" class="i">+    for (size_t i = 0; i &lt; prefilter_vec_.size(); ++i)
</a>       regexps-&gt;push_back(i);
   } else {
     if (!prefilter_vec_.empty()) {
       IntMap regexps_map(prefilter_vec_.size());
       vector&lt;int&gt; matched_atom_ids;
<a href="#h16-12-10" id="h16-12-10" class="d">-      for (int j = 0; j &lt; matched_atoms.size(); j++) {
</a><a href="#h16-12-11" id="h16-12-11" class="i">+      for (size_t j = 0; j &lt; matched_atoms.size(); j++) {
</a>         matched_atom_ids.push_back(atom_index_to_id_[matched_atoms[j]]);
         VLOG(10) &lt;&lt; &quot;Atom id:&quot; &lt;&lt; atom_index_to_id_[matched_atoms[j]];
       }
<a href="#h16-13" id="h16-13" class="h">@@ -311,13 +315,13 @@ void PrefilterTree::PropagateMatch(const vector&lt;int&gt;&amp; atom_ids,
</a>                                    IntMap* regexps) const {
   IntMap count(entries_.size());
   IntMap work(entries_.size());
<a href="#h16-13-3" id="h16-13-3" class="d">-  for (int i = 0; i &lt; atom_ids.size(); i++)
</a><a href="#h16-13-4" id="h16-13-4" class="i">+  for (size_t i = 0; i &lt; atom_ids.size(); i++)
</a>     work.set(atom_ids[i], 1);
   for (IntMap::iterator it = work.begin(); it != work.end(); ++it) {
     const Entry&amp; entry = entries_[it-&gt;index()];
     VLOG(10) &lt;&lt; &quot;Processing: &quot; &lt;&lt; it-&gt;index();
     // Record regexps triggered.
<a href="#h16-13-10" id="h16-13-10" class="d">-    for (int i = 0; i &lt; entry.regexps.size(); i++) {
</a><a href="#h16-13-11" id="h16-13-11" class="i">+    for (size_t i = 0; i &lt; entry.regexps.size(); i++) {
</a>       VLOG(10) &lt;&lt; &quot;Regexp triggered: &quot; &lt;&lt; entry.regexps[i];
       regexps-&gt;set(entry.regexps[i], 1);
     }
<a href="#h16-14" id="h16-14" class="h">@@ -357,7 +361,7 @@ void PrefilterTree::PrintDebugInfo() {
</a>   VLOG(10) &lt;&lt; &quot;#Unique Atoms: &quot; &lt;&lt; atom_index_to_id_.size();
   VLOG(10) &lt;&lt; &quot;#Unique Nodes: &quot; &lt;&lt; entries_.size();
 
<a href="#h16-14-3" id="h16-14-3" class="d">-  for (int i = 0; i &lt; entries_.size(); ++i) {
</a><a href="#h16-14-4" id="h16-14-4" class="i">+  for (size_t i = 0; i &lt; entries_.size(); ++i) {
</a>     StdIntMap* parents = entries_[i].parents;
     const vector&lt;int&gt;&amp; regexps = entries_[i].regexps;
     VLOG(10) &lt;&lt; &quot;EntryId: &quot; &lt;&lt; i
<a href="#h16-15" id="h16-15" class="h">@@ -382,7 +386,7 @@ string PrefilterTree::DebugNodeString(Prefilter* node) const {
</a>     // Adding the operation disambiguates AND and OR nodes.
     node_string +=  node-&gt;op() == Prefilter::AND ? &quot;AND&quot; : &quot;OR&quot;;
     node_string += &quot;(&quot;;
<a href="#h16-15-3" id="h16-15-3" class="d">-    for (int i = 0; i &lt; node-&gt;subs()-&gt;size() ; i++) {
</a><a href="#h16-15-4" id="h16-15-4" class="i">+    for (size_t i = 0; i &lt; node-&gt;subs()-&gt;size(); i++) {
</a>       if (i &gt; 0)
         node_string += &#39;,&#39;;
       node_string += Itoa((*node-&gt;subs())[i]-&gt;unique_id());
<b>diff --git a/<a id="h17" href="../file/src/vendor/re2/re2/prefilter_tree.h">src/vendor/re2/re2/prefilter_tree.h</a> b/<a href="../file/src/vendor/re2/re2/prefilter_tree.h">src/vendor/re2/re2/prefilter_tree.h</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -123,7 +123,7 @@ class PrefilterTree {
</a>   // Has the prefilter tree been compiled.
   bool compiled_;
 
<a href="#h17-0-3" id="h17-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(PrefilterTree);
</a><a href="#h17-0-4" id="h17-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(PrefilterTree);
</a> };
 
 }  // namespace
<b>diff --git a/<a id="h18" href="../file/src/vendor/re2/re2/prog.h">src/vendor/re2/re2/prog.h</a> b/<a href="../file/src/vendor/re2/re2/prog.h">src/vendor/re2/re2/prog.h</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -42,7 +42,7 @@ class Bitmap {
</a>   static const int WordLog = 5;
   static const int Words = (Bits+31)/32;
   uint32 w_[Words];
<a href="#h18-0-3" id="h18-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(Bitmap);
</a><a href="#h18-0-4" id="h18-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(Bitmap);
</a> };
 
 
<a href="#h18-1" id="h18-1" class="h">@@ -167,7 +167,7 @@ class Prog {
</a>     friend struct PatchList;
     friend class Prog;
 
<a href="#h18-1-3" id="h18-1-3" class="d">-    DISALLOW_EVIL_CONSTRUCTORS(Inst);
</a><a href="#h18-1-4" id="h18-1-4" class="i">+    DISALLOW_COPY_AND_ASSIGN(Inst);
</a>   };
 
   // Whether to anchor the search.
<a href="#h18-2" id="h18-2" class="h">@@ -368,7 +368,7 @@ class Prog {
</a>   uint8* onepass_nodes_;     // data for OnePass nodes
   OneState* onepass_start_;  // start node for OnePass program
 
<a href="#h18-2-3" id="h18-2-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(Prog);
</a><a href="#h18-2-4" id="h18-2-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(Prog);
</a> };
 
 }  // namespace re2
<b>diff --git a/<a id="h19" href="../file/src/vendor/re2/re2/re2.cc">src/vendor/re2/re2/re2.cc</a> b/<a href="../file/src/vendor/re2/re2/re2.cc">src/vendor/re2/re2/re2.cc</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -976,16 +976,23 @@ bool RE2::Arg::parse_uchar(const char* str, int n, void* dest) {
</a> // Largest number spec that we are willing to parse
 static const int kMaxNumberLength = 32;
 
<a href="#h19-0-3" id="h19-0-3" class="d">-// REQUIRES &quot;buf&quot; must have length at least kMaxNumberLength+1
</a><a href="#h19-0-4" id="h19-0-4" class="i">+// REQUIRES &quot;buf&quot; must have length at least nbuf.
</a> // Copies &quot;str&quot; into &quot;buf&quot; and null-terminates.
 // Overwrites *np with the new length.
<a href="#h19-0-7" id="h19-0-7" class="d">-static const char* TerminateNumber(char* buf, const char* str, int* np) {
</a><a href="#h19-0-8" id="h19-0-8" class="i">+static const char* TerminateNumber(char* buf, int nbuf, const char* str, int* np,
</a><a href="#h19-0-9" id="h19-0-9" class="i">+                                   bool accept_spaces) {
</a>   int n = *np;
   if (n &lt;= 0) return &quot;&quot;;
   if (n &gt; 0 &amp;&amp; isspace(*str)) {
     // We are less forgiving than the strtoxxx() routines and do not
<a href="#h19-0-14" id="h19-0-14" class="d">-    // allow leading spaces.
</a><a href="#h19-0-15" id="h19-0-15" class="d">-    return &quot;&quot;;
</a><a href="#h19-0-16" id="h19-0-16" class="i">+    // allow leading spaces. We do allow leading spaces for floats.
</a><a href="#h19-0-17" id="h19-0-17" class="i">+    if (!accept_spaces) {
</a><a href="#h19-0-18" id="h19-0-18" class="i">+      return &quot;&quot;;
</a><a href="#h19-0-19" id="h19-0-19" class="i">+    }
</a><a href="#h19-0-20" id="h19-0-20" class="i">+    while (n &gt; 0 &amp;&amp; isspace(*str)) {
</a><a href="#h19-0-21" id="h19-0-21" class="i">+      n--;
</a><a href="#h19-0-22" id="h19-0-22" class="i">+      str++;
</a><a href="#h19-0-23" id="h19-0-23" class="i">+    }
</a>   }
 
   // Although buf has a fixed maximum size, we can still handle
<a href="#h19-1" id="h19-1" class="h">@@ -1015,7 +1022,7 @@ static const char* TerminateNumber(char* buf, const char* str, int* np) {
</a>     str--;
   }
 
<a href="#h19-1-3" id="h19-1-3" class="d">-  if (n &gt; kMaxNumberLength) return &quot;&quot;;
</a><a href="#h19-1-4" id="h19-1-4" class="i">+  if (n &gt; nbuf-1) return &quot;&quot;;
</a> 
   memmove(buf, str, n);
   if (neg) {
<a href="#h19-2" id="h19-2" class="h">@@ -1032,7 +1039,7 @@ bool RE2::Arg::parse_long_radix(const char* str,
</a>                                int radix) {
   if (n == 0) return false;
   char buf[kMaxNumberLength+1];
<a href="#h19-2-3" id="h19-2-3" class="d">-  str = TerminateNumber(buf, str, &amp;n);
</a><a href="#h19-2-4" id="h19-2-4" class="i">+  str = TerminateNumber(buf, sizeof buf, str, &amp;n, false);
</a>   char* end;
   errno = 0;
   long r = strtol(str, &amp;end, radix);
<a href="#h19-3" id="h19-3" class="h">@@ -1049,7 +1056,7 @@ bool RE2::Arg::parse_ulong_radix(const char* str,
</a>                                 int radix) {
   if (n == 0) return false;
   char buf[kMaxNumberLength+1];
<a href="#h19-3-3" id="h19-3-3" class="d">-  str = TerminateNumber(buf, str, &amp;n);
</a><a href="#h19-3-4" id="h19-3-4" class="i">+  str = TerminateNumber(buf, sizeof buf, str, &amp;n, false);
</a>   if (str[0] == &#39;-&#39;) {
    // strtoul() will silently accept negative numbers and parse
    // them.  This module is more strict and treats them as errors.
<a href="#h19-4" id="h19-4" class="h">@@ -1121,7 +1128,7 @@ bool RE2::Arg::parse_longlong_radix(const char* str,
</a>                                    int radix) {
   if (n == 0) return false;
   char buf[kMaxNumberLength+1];
<a href="#h19-4-3" id="h19-4-3" class="d">-  str = TerminateNumber(buf, str, &amp;n);
</a><a href="#h19-4-4" id="h19-4-4" class="i">+  str = TerminateNumber(buf, sizeof buf, str, &amp;n, false);
</a>   char* end;
   errno = 0;
   int64 r = strtoll(str, &amp;end, radix);
<a href="#h19-5" id="h19-5" class="h">@@ -1138,7 +1145,7 @@ bool RE2::Arg::parse_ulonglong_radix(const char* str,
</a>                                     int radix) {
   if (n == 0) return false;
   char buf[kMaxNumberLength+1];
<a href="#h19-5-3" id="h19-5-3" class="d">-  str = TerminateNumber(buf, str, &amp;n);
</a><a href="#h19-5-4" id="h19-5-4" class="i">+  str = TerminateNumber(buf, sizeof buf, str, &amp;n, false);
</a>   if (str[0] == &#39;-&#39;) {
     // strtoull() will silently accept negative numbers and parse
     // them.  This module is more strict and treats them as errors.
<a href="#h19-6" id="h19-6" class="h">@@ -1158,19 +1165,17 @@ bool RE2::Arg::parse_ulonglong_radix(const char* str,
</a> static bool parse_double_float(const char* str, int n, bool isfloat, void *dest) {
   if (n == 0) return false;
   static const int kMaxLength = 200;
<a href="#h19-6-3" id="h19-6-3" class="d">-  char buf[kMaxLength];
</a><a href="#h19-6-4" id="h19-6-4" class="d">-  if (n &gt;= kMaxLength) return false;
</a><a href="#h19-6-5" id="h19-6-5" class="d">-  memcpy(buf, str, n);
</a><a href="#h19-6-6" id="h19-6-6" class="d">-  buf[n] = &#39;\0&#39;;
</a><a href="#h19-6-7" id="h19-6-7" class="d">-  errno = 0;
</a><a href="#h19-6-8" id="h19-6-8" class="i">+  char buf[kMaxLength+1];
</a><a href="#h19-6-9" id="h19-6-9" class="i">+  str = TerminateNumber(buf, sizeof buf, str, &amp;n, true);
</a>   char* end;
<a href="#h19-6-11" id="h19-6-11" class="i">+  errno = 0;
</a>   double r;
   if (isfloat) {
<a href="#h19-6-14" id="h19-6-14" class="d">-    r = strtof(buf, &amp;end);
</a><a href="#h19-6-15" id="h19-6-15" class="i">+    r = strtof(str, &amp;end);
</a>   } else {
<a href="#h19-6-17" id="h19-6-17" class="d">-    r = strtod(buf, &amp;end);
</a><a href="#h19-6-18" id="h19-6-18" class="i">+    r = strtod(str, &amp;end);
</a>   }
<a href="#h19-6-20" id="h19-6-20" class="d">-  if (end != buf + n) return false;   // Leftover junk
</a><a href="#h19-6-21" id="h19-6-21" class="i">+  if (end != str + n) return false;   // Leftover junk
</a>   if (errno) return false;
   if (dest == NULL) return true;
   if (isfloat) {
<b>diff --git a/<a id="h20" href="../file/src/vendor/re2/re2/re2.h">src/vendor/re2/re2/re2.h</a> b/<a href="../file/src/vendor/re2/re2/re2.h">src/vendor/re2/re2/re2.h</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -397,6 +397,8 @@ class RE2 {
</a>   //
   // Returns true iff a match occurred and the extraction happened
   // successfully;  if no match occurs, the string is left unaffected.
<a href="#h20-0-3" id="h20-0-3" class="i">+  //
</a><a href="#h20-0-4" id="h20-0-4" class="i">+  // REQUIRES: &quot;text&quot; must not alias any part of &quot;*out&quot;.
</a>   static bool Extract(const StringPiece &amp;text,
                       const RE2&amp; pattern,
                       const StringPiece &amp;rewrite,
<a href="#h20-1" id="h20-1" class="h">@@ -664,7 +666,7 @@ class RE2 {
</a>     bool word_boundary_;
     bool one_line_;
 
<a href="#h20-1-3" id="h20-1-3" class="d">-    //DISALLOW_EVIL_CONSTRUCTORS(Options);
</a><a href="#h20-1-4" id="h20-1-4" class="i">+    //DISALLOW_COPY_AND_ASSIGN(Options);
</a>     Options(const Options&amp;);
     void operator=(const Options&amp;);
   };
<a href="#h20-2" id="h20-2" class="h">@@ -739,7 +741,7 @@ class RE2 {
</a>   // Map from capture indices to names
   mutable const map&lt;int, string&gt;* group_names_;
 
<a href="#h20-2-3" id="h20-2-3" class="d">-  //DISALLOW_EVIL_CONSTRUCTORS(RE2);
</a><a href="#h20-2-4" id="h20-2-4" class="i">+  //DISALLOW_COPY_AND_ASSIGN(RE2);
</a>   RE2(const RE2&amp;);
   void operator=(const RE2&amp;);
 };
<b>diff --git a/<a id="h21" href="../file/src/vendor/re2/re2/regexp.cc">src/vendor/re2/re2/regexp.cc</a> b/<a href="../file/src/vendor/re2/re2/regexp.cc">src/vendor/re2/re2/regexp.cc</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -43,7 +43,8 @@ Regexp::~Regexp() {
</a>       delete[] runes_;
       break;
     case kRegexpCharClass:
<a href="#h21-0-3" id="h21-0-3" class="d">-      cc_-&gt;Delete();
</a><a href="#h21-0-4" id="h21-0-4" class="i">+      if (cc_)
</a><a href="#h21-0-5" id="h21-0-5" class="i">+        cc_-&gt;Delete();
</a>       delete ccb_;
       break;
   }
<a href="#h21-1" id="h21-1" class="h">@@ -211,6 +212,13 @@ Regexp* Regexp::ConcatOrAlternate(RegexpOp op, Regexp** sub, int nsub,
</a>   if (nsub == 1)
     return sub[0];
 
<a href="#h21-1-3" id="h21-1-3" class="i">+  if (nsub == 0) {
</a><a href="#h21-1-4" id="h21-1-4" class="i">+    if (op == kRegexpAlternate)
</a><a href="#h21-1-5" id="h21-1-5" class="i">+      return new Regexp(kRegexpNoMatch, flags);
</a><a href="#h21-1-6" id="h21-1-6" class="i">+    else
</a><a href="#h21-1-7" id="h21-1-7" class="i">+      return new Regexp(kRegexpEmptyMatch, flags);
</a><a href="#h21-1-8" id="h21-1-8" class="i">+  }
</a><a href="#h21-1-9" id="h21-1-9" class="i">+
</a>   Regexp** subcopy = NULL;
   if (op == kRegexpAlternate &amp;&amp; can_factor) {
     // Going to edit sub; make a copy so we don&#39;t step on caller.
<a href="#h21-2" id="h21-2" class="h">@@ -517,7 +525,7 @@ class NumCapturesWalker : public Regexp::Walker&lt;Ignored&gt; {
</a> 
  private:
   int ncapture_;
<a href="#h21-2-3" id="h21-2-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(NumCapturesWalker);
</a><a href="#h21-2-4" id="h21-2-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(NumCapturesWalker);
</a> };
 
 int Regexp::NumCaptures() {
<a href="#h21-3" id="h21-3" class="h">@@ -561,7 +569,7 @@ class NamedCapturesWalker : public Regexp::Walker&lt;Ignored&gt; {
</a> 
  private:
   map&lt;string, int&gt;* map_;
<a href="#h21-3-3" id="h21-3-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(NamedCapturesWalker);
</a><a href="#h21-3-4" id="h21-3-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(NamedCapturesWalker);
</a> };
 
 map&lt;string, int&gt;* Regexp::NamedCaptures() {
<a href="#h21-4" id="h21-4" class="h">@@ -601,7 +609,7 @@ class CaptureNamesWalker : public Regexp::Walker&lt;Ignored&gt; {
</a> 
  private:
   map&lt;int, string&gt;* map_;
<a href="#h21-4-3" id="h21-4-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(CaptureNamesWalker);
</a><a href="#h21-4-4" id="h21-4-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(CaptureNamesWalker);
</a> };
 
 map&lt;int, string&gt;* Regexp::CaptureNames() {
<a href="#h21-5" id="h21-5" class="h">@@ -849,7 +857,7 @@ void CharClassBuilder::Negate() {
</a>   }
 
   ranges_.clear();
<a href="#h21-5-3" id="h21-5-3" class="d">-  for (int i = 0; i &lt; v.size(); i++)
</a><a href="#h21-5-4" id="h21-5-4" class="i">+  for (size_t i = 0; i &lt; v.size(); i++)
</a>     ranges_.insert(v[i]);
 
   upper_ = AlphaMask &amp; ~upper_;
<a href="#h21-6" id="h21-6" class="h">@@ -916,11 +924,11 @@ bool CharClass::Contains(Rune r) {
</a> 
 CharClass* CharClassBuilder::GetCharClass() {
   CharClass* cc = CharClass::New(ranges_.size());
<a href="#h21-6-3" id="h21-6-3" class="d">-  int n = 0;
</a><a href="#h21-6-4" id="h21-6-4" class="i">+  size_t n = 0;
</a>   for (iterator it = begin(); it != end(); ++it)
     cc-&gt;ranges_[n++] = *it;
   cc-&gt;nranges_ = n;
<a href="#h21-6-8" id="h21-6-8" class="d">-  DCHECK_LE(n, ranges_.size());
</a><a href="#h21-6-9" id="h21-6-9" class="i">+  DCHECK_LE(static_cast&lt;size_t&gt;(n), ranges_.size());
</a>   cc-&gt;nrunes_ = nrunes_;
   cc-&gt;folds_ascii_ = FoldsASCII();
   return cc;
<b>diff --git a/<a id="h22" href="../file/src/vendor/re2/re2/regexp.h">src/vendor/re2/re2/regexp.h</a> b/<a href="../file/src/vendor/re2/re2/regexp.h">src/vendor/re2/re2/regexp.h</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -208,7 +208,7 @@ class RegexpStatus {
</a>   StringPiece error_arg_;       // Piece of regexp containing syntax error.
   string* tmp_;                 // Temporary storage, possibly where error_arg_ is.
 
<a href="#h22-0-3" id="h22-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(RegexpStatus);
</a><a href="#h22-0-4" id="h22-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(RegexpStatus);
</a> };
 
 // Walker to implement Simplify.
<a href="#h22-1" id="h22-1" class="h">@@ -261,7 +261,7 @@ class CharClass {
</a>   int nrunes_;
   RuneRange *ranges_;
   int nranges_;
<a href="#h22-1-3" id="h22-1-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(CharClass);
</a><a href="#h22-1-4" id="h22-1-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(CharClass);
</a> };
 
 class Regexp {
<a href="#h22-2" id="h22-2" class="h">@@ -568,7 +568,7 @@ class Regexp {
</a>     void *the_union_[2];  // as big as any other element, for memset
   };
 
<a href="#h22-2-3" id="h22-2-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(Regexp);
</a><a href="#h22-2-4" id="h22-2-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(Regexp);
</a> };
 
 // Character class set: contains non-overlapping, non-abutting RuneRanges.
<a href="#h22-3" id="h22-3" class="h">@@ -602,7 +602,7 @@ class CharClassBuilder {
</a>   uint32 lower_;  // bitmap of a-z
   int nrunes_;
   RuneRangeSet ranges_;
<a href="#h22-3-3" id="h22-3-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(CharClassBuilder);
</a><a href="#h22-3-4" id="h22-3-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(CharClassBuilder);
</a> };
 
 // Tell g++ that bitwise ops on ParseFlags produce ParseFlags.
<b>diff --git a/<a id="h23" href="../file/src/vendor/re2/re2/set.cc">src/vendor/re2/re2/set.cc</a> b/<a href="../file/src/vendor/re2/re2/set.cc">src/vendor/re2/re2/set.cc</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -20,7 +20,7 @@ RE2::Set::Set(const RE2::Options&amp; options, RE2::Anchor anchor) {
</a> }
 
 RE2::Set::~Set() {
<a href="#h23-0-3" id="h23-0-3" class="d">-  for (int i = 0; i &lt; re_.size(); i++)
</a><a href="#h23-0-4" id="h23-0-4" class="i">+  for (size_t i = 0; i &lt; re_.size(); i++)
</a>     re_[i]-&gt;Decref();
   delete prog_;
 }
<b>diff --git a/<a id="h24" href="../file/src/vendor/re2/re2/set.h">src/vendor/re2/re2/set.h</a> b/<a href="../file/src/vendor/re2/re2/set.h">src/vendor/re2/re2/set.h</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -45,7 +45,7 @@ class RE2::Set {
</a>   vector&lt;re2::Regexp*&gt; re_;
   re2::Prog* prog_;
   bool compiled_;
<a href="#h24-0-3" id="h24-0-3" class="d">-  //DISALLOW_EVIL_CONSTRUCTORS(Set);
</a><a href="#h24-0-4" id="h24-0-4" class="i">+  //DISALLOW_COPY_AND_ASSIGN(Set);
</a>   Set(const Set&amp;);
   void operator=(const Set&amp;);
 };
<b>diff --git a/<a id="h25" href="../file/src/vendor/re2/re2/simplify.cc">src/vendor/re2/re2/simplify.cc</a> b/<a href="../file/src/vendor/re2/re2/simplify.cc">src/vendor/re2/re2/simplify.cc</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -130,7 +130,7 @@ class SimplifyWalker : public Regexp::Walker&lt;Regexp*&gt; {
</a>   // Caller must Decref return value when done with it.
   static Regexp* SimplifyCharClass(Regexp* re);
 
<a href="#h25-0-3" id="h25-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(SimplifyWalker);
</a><a href="#h25-0-4" id="h25-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(SimplifyWalker);
</a> };
 
 // Simplifies a regular expression, returning a new regexp.
<a href="#h25-1" id="h25-1" class="h">@@ -325,7 +325,6 @@ Regexp* SimplifyWalker::SimplifyRepeat(Regexp* re, int min, int max,
</a>     // General case: x{4,} is xxxx+
     Regexp* nre = new Regexp(kRegexpConcat, f);
     nre-&gt;AllocSub(min);
<a href="#h25-1-3" id="h25-1-3" class="d">-    VLOG(1) &lt;&lt; &quot;Simplify &quot; &lt;&lt; min;
</a>     Regexp** nre_subs = nre-&gt;sub();
     for (int i = 0; i &lt; min-1; i++)
       nre_subs[i] = re-&gt;Incref();
<b>diff --git a/<a id="h26" href="../file/src/vendor/re2/re2/stringpiece.h">src/vendor/re2/re2/stringpiece.h</a> b/<a href="../file/src/vendor/re2/re2/stringpiece.h">src/vendor/re2/re2/stringpiece.h</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -138,6 +138,8 @@ class StringPiece {
</a> 
   int copy(char* buf, size_type n, size_type pos = 0) const;
 
<a href="#h26-0-3" id="h26-0-3" class="i">+  bool contains(StringPiece s) const;
</a><a href="#h26-0-4" id="h26-0-4" class="i">+
</a>   int find(const StringPiece&amp; s, size_type pos = 0) const;
   int find(char c, size_type pos = 0) const;
   int rfind(const StringPiece&amp; s, size_type pos = npos) const;
<b>diff --git a/<a id="h27" href="../file/src/vendor/re2/re2/testing/dfa_test.cc">src/vendor/re2/re2/testing/dfa_test.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/dfa_test.cc">src/vendor/re2/re2/testing/dfa_test.cc</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -42,7 +42,7 @@ TEST(Multithreaded, BuildEntireDFA) {
</a>   // Check that single-threaded code works.
   {
     //LOG(INFO) &lt;&lt; s;
<a href="#h27-0-3" id="h27-0-3" class="d">-    Regexp* re = Regexp::Parse(s.c_str(), Regexp::LikePerl, NULL);
</a><a href="#h27-0-4" id="h27-0-4" class="i">+    Regexp* re = Regexp::Parse(s, Regexp::LikePerl, NULL);
</a>     CHECK(re);
     Prog* prog = re-&gt;CompileToProg(0);
     CHECK(prog);
<a href="#h27-1" id="h27-1" class="h">@@ -57,7 +57,7 @@ TEST(Multithreaded, BuildEntireDFA) {
</a> 
   // Build the DFA simultaneously in a bunch of threads.
   for (int i = 0; i &lt; FLAGS_repeat; i++) {
<a href="#h27-1-3" id="h27-1-3" class="d">-    Regexp* re = Regexp::Parse(s.c_str(), Regexp::LikePerl, NULL);
</a><a href="#h27-1-4" id="h27-1-4" class="i">+    Regexp* re = Regexp::Parse(s, Regexp::LikePerl, NULL);
</a>     CHECK(re);
     Prog* prog = re-&gt;CompileToProg(0);
     CHECK(prog);
<a href="#h27-2" id="h27-2" class="h">@@ -93,7 +93,7 @@ TEST(SingleThreaded, BuildEntireDFA) {
</a>   s += &quot;b&quot;;
 
   //LOG(INFO) &lt;&lt; s;
<a href="#h27-2-3" id="h27-2-3" class="d">-  Regexp* re = Regexp::Parse(s.c_str(), Regexp::LikePerl, NULL);
</a><a href="#h27-2-4" id="h27-2-4" class="i">+  Regexp* re = Regexp::Parse(s, Regexp::LikePerl, NULL);
</a>   CHECK(re);
   int max = 24;
   for (int i = 17; i &lt; max; i++) {
<a href="#h27-3" id="h27-3" class="h">@@ -115,7 +115,7 @@ TEST(SingleThreaded, BuildEntireDFA) {
</a>       continue;
     //LOG(INFO) &lt;&lt; StringPrintf(&quot;Limit %d: prog used %d, DFA budget %d, total %d\n&quot;,
     //                          limit, progusage, dfamem, usage);
<a href="#h27-3-3" id="h27-3-3" class="d">-    CHECK_GT(usage, limit*9/10);
</a><a href="#h27-3-4" id="h27-3-4" class="i">+    CHECK_GT(usage, limit*8/10);
</a>     CHECK_LT(usage, limit + (16&lt;&lt;10));  // 16kB of slop okay
   }
   re-&gt;Decref();
<b>diff --git a/<a id="h28" href="../file/src/vendor/re2/re2/testing/exhaustive_tester.cc">src/vendor/re2/re2/testing/exhaustive_tester.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/exhaustive_tester.cc">src/vendor/re2/re2/testing/exhaustive_tester.cc</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -148,7 +148,7 @@ void ExhaustiveTest(int maxatoms, int maxops,
</a>                     int maxstrlen, const vector&lt;string&gt;&amp; stralphabet,
                     const string&amp; wrapper,
                     const string&amp; topwrapper) {
<a href="#h28-0-3" id="h28-0-3" class="d">-  if (DEBUG_MODE &amp;&amp; FLAGS_quick_debug_mode) {
</a><a href="#h28-0-4" id="h28-0-4" class="i">+  if (RE2_DEBUG_MODE &amp;&amp; FLAGS_quick_debug_mode) {
</a>     if (maxatoms &gt; 1)
       maxatoms--;
     if (maxops &gt; 1)
<b>diff --git a/<a id="h29" href="../file/src/vendor/re2/re2/testing/exhaustive_tester.h">src/vendor/re2/re2/testing/exhaustive_tester.h</a> b/<a href="../file/src/vendor/re2/re2/testing/exhaustive_tester.h">src/vendor/re2/re2/testing/exhaustive_tester.h</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -13,6 +13,16 @@
</a> 
 namespace re2 {
 
<a href="#h29-0-3" id="h29-0-3" class="i">+#if !defined(NDEBUG)
</a><a href="#h29-0-4" id="h29-0-4" class="i">+// We are in a debug build.
</a><a href="#h29-0-5" id="h29-0-5" class="i">+const bool RE2_DEBUG_MODE = true;
</a><a href="#h29-0-6" id="h29-0-6" class="i">+#elif ADDRESS_SANITIZER || MEMORY_SANITIZER || THREAD_SANITIZER
</a><a href="#h29-0-7" id="h29-0-7" class="i">+// Not a debug build, but still under sanitizers.
</a><a href="#h29-0-8" id="h29-0-8" class="i">+const bool RE2_DEBUG_MODE = true;
</a><a href="#h29-0-9" id="h29-0-9" class="i">+#else
</a><a href="#h29-0-10" id="h29-0-10" class="i">+const bool RE2_DEBUG_MODE = false;
</a><a href="#h29-0-11" id="h29-0-11" class="i">+#endif
</a><a href="#h29-0-12" id="h29-0-12" class="i">+
</a> // Exhaustive regular expression test: generate all regexps within parameters,
 // then generate all strings of a given length over a given alphabet,
 // then check that NFA, DFA, and PCRE agree about whether each regexp matches
<a href="#h29-1" id="h29-1" class="h">@@ -63,7 +73,7 @@ class ExhaustiveTester : public RegexpGenerator {
</a>   bool randomstrings_;  // Whether to use random strings
   int32 stringseed_;    // If so, the seed.
   int stringcount_;     // If so, how many to generate.
<a href="#h29-1-3" id="h29-1-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(ExhaustiveTester);
</a><a href="#h29-1-4" id="h29-1-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(ExhaustiveTester);
</a> };
 
 // Runs an exhaustive test on the given parameters.
<b>diff --git a/<a id="h30" href="../file/src/vendor/re2/re2/testing/filtered_re2_test.cc">src/vendor/re2/re2/testing/filtered_re2_test.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/filtered_re2_test.cc">src/vendor/re2/re2/testing/filtered_re2_test.cc</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -158,10 +158,10 @@ bool CheckExpectedAtoms(const char* atoms[],
</a>   if (!pass) {
     LOG(WARNING) &lt;&lt; &quot;Failed &quot; &lt;&lt; testname;
     LOG(WARNING) &lt;&lt; &quot;Expected #atoms = &quot; &lt;&lt; expected.size();
<a href="#h30-0-3" id="h30-0-3" class="d">-    for (int i = 0; i &lt; expected.size(); i++)
</a><a href="#h30-0-4" id="h30-0-4" class="i">+    for (size_t i = 0; i &lt; expected.size(); i++)
</a>       LOG(WARNING) &lt;&lt; expected[i];
     LOG(WARNING) &lt;&lt; &quot;Found #atoms = &quot; &lt;&lt; v-&gt;atoms.size();
<a href="#h30-0-7" id="h30-0-7" class="d">-    for (int i = 0; i &lt; v-&gt;atoms.size(); i++)
</a><a href="#h30-0-8" id="h30-0-8" class="i">+    for (size_t i = 0; i &lt; v-&gt;atoms.size(); i++)
</a>       LOG(WARNING) &lt;&lt; v-&gt;atoms[i];
   }
 
<a href="#h30-1" id="h30-1" class="h">@@ -193,8 +193,8 @@ void FindAtomIndices(const vector&lt;string&gt; atoms,
</a>                      const vector&lt;string&gt; matched_atoms,
                      vector&lt;int&gt;* atom_indices) {
   atom_indices-&gt;clear();
<a href="#h30-1-3" id="h30-1-3" class="d">-  for (int i = 0; i &lt; matched_atoms.size(); i++) {
</a><a href="#h30-1-4" id="h30-1-4" class="d">-    int j = 0;
</a><a href="#h30-1-5" id="h30-1-5" class="i">+  for (size_t i = 0; i &lt; matched_atoms.size(); i++) {
</a><a href="#h30-1-6" id="h30-1-6" class="i">+    size_t j = 0;
</a>     for (; j &lt; atoms.size(); j++) {
       if (matched_atoms[i] == atoms[j]) {
         atom_indices-&gt;push_back(j);
<a href="#h30-2" id="h30-2" class="h">@@ -266,7 +266,7 @@ TEST(FilteredRE2Test, MatchTests) {
</a>   atoms.push_back(&quot;yyyzzz&quot;);
   FindAtomIndices(v.atoms, atoms, &amp;atom_ids);
   LOG(INFO) &lt;&lt; &quot;S: &quot; &lt;&lt; atom_ids.size();
<a href="#h30-2-3" id="h30-2-3" class="d">-  for (int i = 0; i &lt; atom_ids.size(); i++)
</a><a href="#h30-2-4" id="h30-2-4" class="i">+  for (size_t i = 0; i &lt; atom_ids.size(); i++)
</a>     LOG(INFO) &lt;&lt; &quot;i: &quot; &lt;&lt; i &lt;&lt; &quot; : &quot; &lt;&lt; atom_ids[i];
   v.f.AllMatches(text, atom_ids, &amp;matching_regexps);
   EXPECT_EQ(2, matching_regexps.size());
<b>diff --git a/<a id="h31" href="../file/src/vendor/re2/re2/testing/null_walker.cc">src/vendor/re2/re2/testing/null_walker.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/null_walker.cc">src/vendor/re2/re2/testing/null_walker.cc</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -23,7 +23,7 @@ class NullWalker : public Regexp::Walker&lt;bool&gt; {
</a>   }
 
  private:
<a href="#h31-0-3" id="h31-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(NullWalker);
</a><a href="#h31-0-4" id="h31-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(NullWalker);
</a> };
 
 // Called after visiting re&#39;s children.  child_args contains the return
<b>diff --git a/<a id="h32" href="../file/src/vendor/re2/re2/testing/possible_match_test.cc">src/vendor/re2/re2/testing/possible_match_test.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/possible_match_test.cc">src/vendor/re2/re2/testing/possible_match_test.cc</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -7,6 +7,7 @@
</a> #include &quot;re2/prog.h&quot;
 #include &quot;re2/re2.h&quot;
 #include &quot;re2/regexp.h&quot;
<a href="#h32-0-3" id="h32-0-3" class="i">+#include &quot;re2/testing/exhaustive_tester.h&quot;
</a> #include &quot;re2/testing/regexp_generator.h&quot;
 #include &quot;re2/testing/string_generator.h&quot;
 
<a href="#h32-1" id="h32-1" class="h">@@ -136,26 +137,26 @@ TEST(PossibleMatchRange, Failures) {
</a>   // are no valid UTF-8 strings beginning with byte 0xFF.
   EXPECT_FALSE(RE2(&quot;[\\s\\S]+&quot;, RE2::Latin1).
                PossibleMatchRange(&amp;min, &amp;max, 10))
<a href="#h32-1-3" id="h32-1-3" class="d">-    &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a><a href="#h32-1-4" id="h32-1-4" class="i">+      &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a>   EXPECT_FALSE(RE2(&quot;[\\0-\xFF]+&quot;, RE2::Latin1).
                PossibleMatchRange(&amp;min, &amp;max, 10))
<a href="#h32-1-7" id="h32-1-7" class="d">-    &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a><a href="#h32-1-8" id="h32-1-8" class="i">+      &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a>   EXPECT_FALSE(RE2(&quot;.+hello&quot;, RE2::Latin1).
                PossibleMatchRange(&amp;min, &amp;max, 10))
<a href="#h32-1-11" id="h32-1-11" class="d">-    &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a><a href="#h32-1-12" id="h32-1-12" class="i">+      &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a>   EXPECT_FALSE(RE2(&quot;.*hello&quot;, RE2::Latin1).
                PossibleMatchRange(&amp;min, &amp;max, 10))
<a href="#h32-1-15" id="h32-1-15" class="d">-    &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a><a href="#h32-1-16" id="h32-1-16" class="i">+      &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a>   EXPECT_FALSE(RE2(&quot;.*&quot;, RE2::Latin1).
                PossibleMatchRange(&amp;min, &amp;max, 10))
<a href="#h32-1-19" id="h32-1-19" class="d">-    &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a><a href="#h32-1-20" id="h32-1-20" class="i">+      &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a>   EXPECT_FALSE(RE2(&quot;\\C*&quot;).
                PossibleMatchRange(&amp;min, &amp;max, 10))
<a href="#h32-1-23" id="h32-1-23" class="d">-    &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a><a href="#h32-1-24" id="h32-1-24" class="i">+      &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a> 
   // Fails because it&#39;s a malformed regexp.
   EXPECT_FALSE(RE2(&quot;*hello&quot;).PossibleMatchRange(&amp;min, &amp;max, 10))
<a href="#h32-1-28" id="h32-1-28" class="d">-    &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a><a href="#h32-1-29" id="h32-1-29" class="i">+      &lt;&lt; &quot;min=&quot; &lt;&lt; CEscape(min) &lt;&lt; &quot;, max=&quot; &lt;&lt; CEscape(max);
</a> }
 
 // Exhaustive test: generate all regexps within parameters,
<a href="#h32-2" id="h32-2" class="h">@@ -186,7 +187,7 @@ class PossibleMatchTester : public RegexpGenerator {
</a>   int regexps_;   // Number of HandleRegexp calls
   int tests_;     // Number of regexp tests.
 
<a href="#h32-2-3" id="h32-2-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(PossibleMatchTester);
</a><a href="#h32-2-4" id="h32-2-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(PossibleMatchTester);
</a> };
 
 // Processes a single generated regexp.
<a href="#h32-3" id="h32-3" class="h">@@ -224,7 +225,7 @@ TEST(PossibleMatchRange, Exhaustive) {
</a>   int natom = 3;
   int noperator = 3;
   int stringlen = 5;
<a href="#h32-3-3" id="h32-3-3" class="d">-  if (DEBUG_MODE) {
</a><a href="#h32-3-4" id="h32-3-4" class="i">+  if (RE2_DEBUG_MODE) {
</a>     natom = 2;
     noperator = 3;
     stringlen = 3;
<b>diff --git a/<a id="h33" href="../file/src/vendor/re2/re2/testing/random_test.cc">src/vendor/re2/re2/testing/random_test.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/random_test.cc">src/vendor/re2/re2/testing/random_test.cc</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -25,7 +25,7 @@ static void RandomTest(int maxatoms, int maxops,
</a>                        const string&amp; wrapper) {
   // Limit to smaller test cases in debug mode,
   // because everything is so much slower.
<a href="#h33-0-3" id="h33-0-3" class="d">-  if (DEBUG_MODE) {
</a><a href="#h33-0-4" id="h33-0-4" class="i">+  if (RE2_DEBUG_MODE) {
</a>     maxatoms--;
     maxops--;
     maxstrlen /= 2;
<b>diff --git a/<a id="h34" href="../file/src/vendor/re2/re2/testing/re2_arg_test.cc">src/vendor/re2/re2/testing/re2_arg_test.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/re2_arg_test.cc">src/vendor/re2/re2/testing/re2_arg_test.cc</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -84,7 +84,7 @@ const SuccessTable kSuccessTable[] = {
</a> { &quot;18446744073709551616&quot;, 0,    { false, false, false, false, false, false }},
 };
 
<a href="#h34-0-3" id="h34-0-3" class="d">-const int kNumStrings = ARRAYSIZE(kSuccessTable);
</a><a href="#h34-0-4" id="h34-0-4" class="i">+const int kNumStrings = arraysize(kSuccessTable);
</a> 
 // It&#39;s ugly to use a macro, but we apparently can&#39;t use the ASSERT_TRUE_M
 // macro outside of a TEST block and this seems to be the only way to
<a href="#h34-1" id="h34-1" class="h">@@ -101,7 +101,7 @@ const int kNumStrings = ARRAYSIZE(kSuccessTable);
</a>       StringPrintf(&quot;Parsing &#39;%s&#39; for type &quot; #type &quot; should return %d&quot;,   \
                    p, success).c_str());                                 \
     if ( success ) {                                                     \
<a href="#h34-1-3" id="h34-1-3" class="d">-      ASSERT_EQUALS(r, kSuccessTable[i].value);                          \
</a><a href="#h34-1-4" id="h34-1-4" class="i">+      ASSERT_EQUALS(r, (type)kSuccessTable[i].value);                          \
</a>     }                                                                    \
   }                                                                      \
 }
<b>diff --git a/<a id="h35" href="../file/src/vendor/re2/re2/testing/re2_test.cc">src/vendor/re2/re2/testing/re2_test.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/re2_test.cc">src/vendor/re2/re2/testing/re2_test.cc</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -519,6 +519,34 @@ TEST(Capture, NamedGroups) {
</a>   }
 }
 
<a href="#h35-0-3" id="h35-0-3" class="i">+TEST(RE2, CapturedGroupTest) {
</a><a href="#h35-0-4" id="h35-0-4" class="i">+  RE2 re(&quot;directions from (?P&lt;S&gt;.*) to (?P&lt;D&gt;.*)&quot;);
</a><a href="#h35-0-5" id="h35-0-5" class="i">+  int num_groups = re.NumberOfCapturingGroups();
</a><a href="#h35-0-6" id="h35-0-6" class="i">+  EXPECT_EQ(2, num_groups);
</a><a href="#h35-0-7" id="h35-0-7" class="i">+  string args[4];
</a><a href="#h35-0-8" id="h35-0-8" class="i">+  RE2::Arg arg0(&amp;args[0]);
</a><a href="#h35-0-9" id="h35-0-9" class="i">+  RE2::Arg arg1(&amp;args[1]);
</a><a href="#h35-0-10" id="h35-0-10" class="i">+  RE2::Arg arg2(&amp;args[2]);
</a><a href="#h35-0-11" id="h35-0-11" class="i">+  RE2::Arg arg3(&amp;args[3]);
</a><a href="#h35-0-12" id="h35-0-12" class="i">+
</a><a href="#h35-0-13" id="h35-0-13" class="i">+  const RE2::Arg* const matches[4] = {&amp;arg0, &amp;arg1, &amp;arg2, &amp;arg3};
</a><a href="#h35-0-14" id="h35-0-14" class="i">+  EXPECT_TRUE(RE2::FullMatchN(&quot;directions from mountain view to san jose&quot;,
</a><a href="#h35-0-15" id="h35-0-15" class="i">+                              re, matches, num_groups));
</a><a href="#h35-0-16" id="h35-0-16" class="i">+  const map&lt;string, int&gt;&amp; named_groups = re.NamedCapturingGroups();
</a><a href="#h35-0-17" id="h35-0-17" class="i">+  EXPECT_TRUE(named_groups.find(&quot;S&quot;) != named_groups.end());
</a><a href="#h35-0-18" id="h35-0-18" class="i">+  EXPECT_TRUE(named_groups.find(&quot;D&quot;) != named_groups.end());
</a><a href="#h35-0-19" id="h35-0-19" class="i">+
</a><a href="#h35-0-20" id="h35-0-20" class="i">+  // The named group index is 1-based.
</a><a href="#h35-0-21" id="h35-0-21" class="i">+  int source_group_index = named_groups.find(&quot;S&quot;)-&gt;second;
</a><a href="#h35-0-22" id="h35-0-22" class="i">+  int destination_group_index = named_groups.find(&quot;D&quot;)-&gt;second;
</a><a href="#h35-0-23" id="h35-0-23" class="i">+  EXPECT_EQ(1, source_group_index);
</a><a href="#h35-0-24" id="h35-0-24" class="i">+  EXPECT_EQ(2, destination_group_index);
</a><a href="#h35-0-25" id="h35-0-25" class="i">+
</a><a href="#h35-0-26" id="h35-0-26" class="i">+  // The args is zero-based.
</a><a href="#h35-0-27" id="h35-0-27" class="i">+  EXPECT_EQ(&quot;mountain view&quot;, args[source_group_index - 1]);
</a><a href="#h35-0-28" id="h35-0-28" class="i">+  EXPECT_EQ(&quot;san jose&quot;, args[destination_group_index - 1]);
</a><a href="#h35-0-29" id="h35-0-29" class="i">+}
</a><a href="#h35-0-30" id="h35-0-30" class="i">+
</a> TEST(RE2, FullMatchWithNoArgs) {
   CHECK(RE2::FullMatch(&quot;h&quot;, &quot;h&quot;));
   CHECK(RE2::FullMatch(&quot;hello&quot;, &quot;hello&quot;));
<a href="#h35-1" id="h35-1" class="h">@@ -696,7 +724,7 @@ TEST(RE2, NULTerminated) {
</a> 
 TEST(RE2, FullMatchTypeTests) {
   // Type tests
<a href="#h35-1-3" id="h35-1-3" class="d">-  string zeros(100, &#39;0&#39;);
</a><a href="#h35-1-4" id="h35-1-4" class="i">+  string zeros(1000, &#39;0&#39;);
</a>   {
     char c;
     CHECK(RE2::FullMatch(&quot;Hello&quot;, &quot;(H)ello&quot;, &amp;c));
<a href="#h35-2" id="h35-2" class="h">@@ -798,12 +826,13 @@ TEST(RE2, FullMatchTypeTests) {
</a> }
 
 TEST(RE2, FloatingPointFullMatchTypes) {
<a href="#h35-2-3" id="h35-2-3" class="d">-  string zeros(100, &#39;0&#39;);
</a><a href="#h35-2-4" id="h35-2-4" class="i">+  string zeros(1000, &#39;0&#39;);
</a>   {
     float v;
     CHECK(RE2::FullMatch(&quot;100&quot;,   &quot;(.*)&quot;, &amp;v));  CHECK_EQ(v, 100);
     CHECK(RE2::FullMatch(&quot;-100.&quot;, &quot;(.*)&quot;, &amp;v));  CHECK_EQ(v, -100);
     CHECK(RE2::FullMatch(&quot;1e23&quot;,  &quot;(.*)&quot;, &amp;v));  CHECK_EQ(v, float(1e23));
<a href="#h35-2-10" id="h35-2-10" class="i">+    CHECK(RE2::FullMatch(&quot; 100&quot;,  &quot;(.*)&quot;, &amp;v));  CHECK_EQ(v, 100);
</a> 
     CHECK(RE2::FullMatch(zeros + &quot;1e23&quot;,  &quot;(.*)&quot;, &amp;v));
     CHECK_EQ(v, float(1e23));
<a href="#h35-3" id="h35-3" class="h">@@ -1401,4 +1430,49 @@ TEST(RE2, Bug10131674) {
</a>   EXPECT_FALSE(RE2::FullMatch(&quot;hello world&quot;, re));
 }
 
<a href="#h35-3-3" id="h35-3-3" class="i">+TEST(RE2, Bug18391750) {
</a><a href="#h35-3-4" id="h35-3-4" class="i">+  // Stray write past end of match_ in nfa.cc, caught by fuzzing + address sanitizer.
</a><a href="#h35-3-5" id="h35-3-5" class="i">+  char t[] = {0x28, 0x28, 0xfc, 0xfc, 0x8,  0x8,  0x26, 0x26, 0x28, 0xc2, 0x9b,
</a><a href="#h35-3-6" id="h35-3-6" class="i">+              0xc5, 0xc5, 0xd4, 0x8f, 0x8f, 0x69, 0x69, 0xe7, 0x29, 0x7b, 0x37,
</a><a href="#h35-3-7" id="h35-3-7" class="i">+              0x31, 0x31, 0x7d, 0xae, 0x7c, 0x7c, 0xf3, 0x29, 0xae, 0xae, 0x2e,
</a><a href="#h35-3-8" id="h35-3-8" class="i">+              0x2a, 0x29, 0x0};
</a><a href="#h35-3-9" id="h35-3-9" class="i">+  RE2::Options opt;
</a><a href="#h35-3-10" id="h35-3-10" class="i">+  opt.set_encoding(RE2::Options::EncodingLatin1);
</a><a href="#h35-3-11" id="h35-3-11" class="i">+  opt.set_longest_match(true);
</a><a href="#h35-3-12" id="h35-3-12" class="i">+  opt.set_dot_nl(true);
</a><a href="#h35-3-13" id="h35-3-13" class="i">+  opt.set_case_sensitive(false);
</a><a href="#h35-3-14" id="h35-3-14" class="i">+  RE2 re(t, opt);
</a><a href="#h35-3-15" id="h35-3-15" class="i">+  CHECK(re.ok());
</a><a href="#h35-3-16" id="h35-3-16" class="i">+  RE2::PartialMatch(t, re);
</a><a href="#h35-3-17" id="h35-3-17" class="i">+}
</a><a href="#h35-3-18" id="h35-3-18" class="i">+
</a><a href="#h35-3-19" id="h35-3-19" class="i">+TEST(RE2, Bug18458852) {
</a><a href="#h35-3-20" id="h35-3-20" class="i">+  // Bug in parser accepting invalid (too large) rune,
</a><a href="#h35-3-21" id="h35-3-21" class="i">+  // causing compiler to fail in DCHECK in UTF-8
</a><a href="#h35-3-22" id="h35-3-22" class="i">+  // character class code.
</a><a href="#h35-3-23" id="h35-3-23" class="i">+  char b[] = {0x28, 0x5,  0x5,  0x41, 0x41, 0x28, 0x24, 0x5b, 0x5e,
</a><a href="#h35-3-24" id="h35-3-24" class="i">+              0xf5, 0x87, 0x87, 0x90, 0x29, 0x5d, 0x29, 0x29, 0x0};
</a><a href="#h35-3-25" id="h35-3-25" class="i">+  RE2 re(b);
</a><a href="#h35-3-26" id="h35-3-26" class="i">+  CHECK(!re.ok());
</a><a href="#h35-3-27" id="h35-3-27" class="i">+}
</a><a href="#h35-3-28" id="h35-3-28" class="i">+
</a><a href="#h35-3-29" id="h35-3-29" class="i">+TEST(RE2, Bug18523943) {
</a><a href="#h35-3-30" id="h35-3-30" class="i">+  // Bug in bitstate: case kFailInst was merged into the default with LOG(DFATAL).
</a><a href="#h35-3-31" id="h35-3-31" class="i">+
</a><a href="#h35-3-32" id="h35-3-32" class="i">+  RE2::Options opt;
</a><a href="#h35-3-33" id="h35-3-33" class="i">+  char a[] = {0x29, 0x29, 0x24, 0x0};
</a><a href="#h35-3-34" id="h35-3-34" class="i">+  char b[] = {0x28, 0xa, 0x2a, 0x2a, 0x29, 0x0};
</a><a href="#h35-3-35" id="h35-3-35" class="i">+  opt.set_log_errors(false);
</a><a href="#h35-3-36" id="h35-3-36" class="i">+  opt.set_encoding(RE2::Options::EncodingLatin1);
</a><a href="#h35-3-37" id="h35-3-37" class="i">+  opt.set_posix_syntax(true);
</a><a href="#h35-3-38" id="h35-3-38" class="i">+  opt.set_longest_match(true);
</a><a href="#h35-3-39" id="h35-3-39" class="i">+  opt.set_literal(false);
</a><a href="#h35-3-40" id="h35-3-40" class="i">+  opt.set_never_nl(true);
</a><a href="#h35-3-41" id="h35-3-41" class="i">+
</a><a href="#h35-3-42" id="h35-3-42" class="i">+  RE2 re((const char*)b, opt);
</a><a href="#h35-3-43" id="h35-3-43" class="i">+  CHECK(re.ok());
</a><a href="#h35-3-44" id="h35-3-44" class="i">+  string s1;
</a><a href="#h35-3-45" id="h35-3-45" class="i">+  CHECK(!RE2::PartialMatch((const char*)a, re, &amp;s1));
</a><a href="#h35-3-46" id="h35-3-46" class="i">+}
</a><a href="#h35-3-47" id="h35-3-47" class="i">+
</a> }  // namespace re2
<b>diff --git a/<a id="h36" href="../file/src/vendor/re2/re2/testing/regexp_generator.cc">src/vendor/re2/re2/testing/regexp_generator.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/regexp_generator.cc">src/vendor/re2/re2/testing/regexp_generator.cc</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -111,7 +111,7 @@ void RegexpGenerator::GeneratePostfix(vector&lt;string&gt;* post, int nstk,
</a> 
   // Add atoms if there is room.
   if (atoms &lt; maxatoms_) {
<a href="#h36-0-3" id="h36-0-3" class="d">-    for (int i = 0; i &lt; atoms_.size(); i++) {
</a><a href="#h36-0-4" id="h36-0-4" class="i">+    for (size_t i = 0; i &lt; atoms_.size(); i++) {
</a>       post-&gt;push_back(atoms_[i]);
       GeneratePostfix(post, nstk + 1, ops, atoms + 1);
       post-&gt;pop_back();
<a href="#h36-1" id="h36-1" class="h">@@ -120,7 +120,7 @@ void RegexpGenerator::GeneratePostfix(vector&lt;string&gt;* post, int nstk,
</a> 
   // Add operators if there are enough arguments.
   if (ops &lt; maxops_) {
<a href="#h36-1-3" id="h36-1-3" class="d">-    for (int i = 0; i &lt; ops_.size(); i++) {
</a><a href="#h36-1-4" id="h36-1-4" class="i">+    for (size_t i = 0; i &lt; ops_.size(); i++) {
</a>       const string&amp; fmt = ops_[i];
       int nargs = CountArgs(fmt);
       if (nargs &lt;= nstk) {
<a href="#h36-2" id="h36-2" class="h">@@ -179,7 +179,7 @@ bool RegexpGenerator::GenerateRandomPostfix(vector&lt;string&gt; *post, int nstk,
</a> // in (?: ) to avoid needing to maintain a precedence table.
 void RegexpGenerator::RunPostfix(const vector&lt;string&gt;&amp; post) {
   stack&lt;string&gt; regexps;
<a href="#h36-2-3" id="h36-2-3" class="d">-  for (int i = 0; i &lt; post.size(); i++) {
</a><a href="#h36-2-4" id="h36-2-4" class="i">+  for (size_t i = 0; i &lt; post.size(); i++) {
</a>     switch (CountArgs(post[i])) {
       default:
         LOG(FATAL) &lt;&lt; &quot;Bad operator: &quot; &lt;&lt; post[i];
<a href="#h36-3" id="h36-3" class="h">@@ -208,7 +208,7 @@ void RegexpGenerator::RunPostfix(const vector&lt;string&gt;&amp; post) {
</a>   if (regexps.size() != 1) {
     // Internal error - should never happen.
     printf(&quot;Bad regexp program:\n&quot;);
<a href="#h36-3-3" id="h36-3-3" class="d">-    for (int i = 0; i &lt; post.size(); i++) {
</a><a href="#h36-3-4" id="h36-3-4" class="i">+    for (size_t i = 0; i &lt; post.size(); i++) {
</a>       printf(&quot;  %s\n&quot;, CEscape(post[i]).c_str());
     }
     printf(&quot;Stack after running program:\n&quot;);
<b>diff --git a/<a id="h37" href="../file/src/vendor/re2/re2/testing/regexp_generator.h">src/vendor/re2/re2/testing/regexp_generator.h</a> b/<a href="../file/src/vendor/re2/re2/testing/regexp_generator.h">src/vendor/re2/re2/testing/regexp_generator.h</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -53,7 +53,7 @@ class RegexpGenerator {
</a>   vector&lt;string&gt; atoms_;   // Possible atoms.
   vector&lt;string&gt; ops_;     // Possible ops.
   ACMRandom* acm_;         // Random generator.
<a href="#h37-0-3" id="h37-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(RegexpGenerator);
</a><a href="#h37-0-4" id="h37-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(RegexpGenerator);
</a> };
 
 // Helpers for preparing arguments to RegexpGenerator constructor.
<b>diff --git a/<a id="h38" href="../file/src/vendor/re2/re2/testing/regexp_test.cc">src/vendor/re2/re2/testing/regexp_test.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/regexp_test.cc">src/vendor/re2/re2/testing/regexp_test.cc</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -29,9 +29,9 @@ TEST(Regexp, BigConcat) {
</a>   Regexp* x;
   x = Regexp::Parse(&quot;x&quot;, Regexp::NoParseFlags, NULL);
   vector&lt;Regexp*&gt; v(90000, x);  // ToString bails out at 100000
<a href="#h38-0-3" id="h38-0-3" class="d">-  for (int i = 0; i &lt; v.size(); i++)
</a><a href="#h38-0-4" id="h38-0-4" class="i">+  for (size_t i = 0; i &lt; v.size(); i++)
</a>     x-&gt;Incref();
<a href="#h38-0-6" id="h38-0-6" class="d">-  CHECK_EQ(x-&gt;Ref(), 1 + v.size()) &lt;&lt; x-&gt;Ref();
</a><a href="#h38-0-7" id="h38-0-7" class="i">+  CHECK_EQ(x-&gt;Ref(), 1 + static_cast&lt;int&gt;(v.size())) &lt;&lt; x-&gt;Ref();
</a>   Regexp* re = Regexp::Concat(&amp;v[0], v.size(), Regexp::NoParseFlags);
   CHECK_EQ(re-&gt;ToString(), string(v.size(), &#39;x&#39;));
   re-&gt;Decref();
<b>diff --git a/<a id="h39" href="../file/src/vendor/re2/re2/testing/required_prefix_test.cc">src/vendor/re2/re2/testing/required_prefix_test.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/required_prefix_test.cc">src/vendor/re2/re2/testing/required_prefix_test.cc</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -28,7 +28,7 @@ static PrefixTest tests[] = {
</a> 
   // Otherwise, it should work.
   { &quot;^abc$&quot;, true, &quot;abc&quot;, false, &quot;(?-m:$)&quot; },
<a href="#h39-0-3" id="h39-0-3" class="d">-  { &quot;^abc&quot;, &quot;true&quot;, &quot;abc&quot;, false, &quot;&quot; },
</a><a href="#h39-0-4" id="h39-0-4" class="i">+  { &quot;^abc&quot;, true, &quot;abc&quot;, false, &quot;&quot; },
</a>   { &quot;^(?i)abc&quot;, true, &quot;abc&quot;, true, &quot;&quot; },
   { &quot;^abcd*&quot;, true, &quot;abc&quot;, false, &quot;d*&quot; },
   { &quot;^[Aa][Bb]cd*&quot;, true, &quot;ab&quot;, true, &quot;cd*&quot; },
<b>diff --git a/<a id="h40" href="../file/src/vendor/re2/re2/testing/string_generator.cc">src/vendor/re2/re2/testing/string_generator.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/string_generator.cc">src/vendor/re2/re2/testing/string_generator.cc</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -44,13 +44,13 @@ void StringGenerator::Reset() {
</a> bool StringGenerator::IncrementDigits() {
   // First try to increment the current number.
   for (int i = digits_.size() - 1; i &gt;= 0; i--) {
<a href="#h40-0-3" id="h40-0-3" class="d">-    if (++digits_[i] &lt; alphabet_.size())
</a><a href="#h40-0-4" id="h40-0-4" class="i">+    if (++digits_[i] &lt; static_cast&lt;int&gt;(alphabet_.size()))
</a>       return true;
     digits_[i] = 0;
   }
 
   // If that failed, make a longer number.
<a href="#h40-0-10" id="h40-0-10" class="d">-  if (digits_.size() &lt; maxlen_) {
</a><a href="#h40-0-11" id="h40-0-11" class="i">+  if (digits_.size() &lt; static_cast&lt;size_t&gt;(maxlen_)) {
</a>     digits_.push_back(0);
     return true;
   }
<a href="#h40-1" id="h40-1" class="h">@@ -84,7 +84,7 @@ const StringPiece&amp; StringGenerator::Next() {
</a>     return sp_;
   }
   s_.clear();
<a href="#h40-1-3" id="h40-1-3" class="d">-  for (int i = 0; i &lt; digits_.size(); i++) {
</a><a href="#h40-1-4" id="h40-1-4" class="i">+  for (size_t i = 0; i &lt; digits_.size(); i++) {
</a>     s_ += alphabet_[digits_[i]];
   }
   hasnext_ = random_ ? RandomDigits() : IncrementDigits();
<b>diff --git a/<a id="h41" href="../file/src/vendor/re2/re2/testing/string_generator.h">src/vendor/re2/re2/testing/string_generator.h</a> b/<a href="../file/src/vendor/re2/re2/testing/string_generator.h">src/vendor/re2/re2/testing/string_generator.h</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -50,7 +50,7 @@ class StringGenerator {
</a>   bool random_;              // Whether generated strings are random.
   int nrandom_;              // Number of random strings left to generate.
   ACMRandom* acm_;           // Random number generator
<a href="#h41-0-3" id="h41-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(StringGenerator);
</a><a href="#h41-0-4" id="h41-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(StringGenerator);
</a> };
 
 }  // namespace re2
<b>diff --git a/<a id="h42" href="../file/src/vendor/re2/re2/testing/tester.cc">src/vendor/re2/re2/testing/tester.cc</a> b/<a href="../file/src/vendor/re2/re2/testing/tester.cc">src/vendor/re2/re2/testing/tester.cc</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -246,6 +246,7 @@ TestInstance::TestInstance(const StringPiece&amp; regexp_str, Prog::MatchKind kind,
</a>   // 2. It treats $ as this weird thing meaning end of string
   //    or before the \n at the end of the string.
   // 3. It doesn&#39;t implement POSIX leftmost-longest matching.
<a href="#h42-0-3" id="h42-0-3" class="i">+  // 4. It lets \s match vertical tab.
</a>   // MimicsPCRE() detects 1 and 2.
   if ((Engines() &amp; (1&lt;&lt;kEnginePCRE)) &amp;&amp; regexp_-&gt;MimicsPCRE() &amp;&amp;
       kind_ != Prog::kLongestMatch) {
<a href="#h42-1" id="h42-1" class="h">@@ -343,7 +344,8 @@ void TestInstance::RunSearch(Engine type,
</a>                                Prog::kAnchored, Prog::kLongestMatch,
                                result-&gt;submatch,
                                &amp;result-&gt;skipped, NULL)) {
<a href="#h42-1-3" id="h42-1-3" class="d">-          LOG(ERROR) &lt;&lt; &quot;Reverse DFA inconsistency: &quot; &lt;&lt; CEscape(regexp_str_)
</a><a href="#h42-1-4" id="h42-1-4" class="i">+          LOG(ERROR) &lt;&lt; &quot;Reverse DFA inconsistency: &quot;
</a><a href="#h42-1-5" id="h42-1-5" class="i">+                     &lt;&lt; CEscape(regexp_str_)
</a>                      &lt;&lt; &quot; on &quot; &lt;&lt; CEscape(text);
           result-&gt;matched = false;
         }
<a href="#h42-2" id="h42-2" class="h">@@ -405,6 +407,14 @@ void TestInstance::RunSearch(Engine type,
</a>         break;
       }
 
<a href="#h42-2-3" id="h42-2-3" class="i">+      // PCRE 8.34 or so started allowing vertical tab to match \s,
</a><a href="#h42-2-4" id="h42-2-4" class="i">+      // following a change made in Perl 5.18. RE2 does not.
</a><a href="#h42-2-5" id="h42-2-5" class="i">+      if ((regexp_str_.contains(&quot;\\s&quot;) || regexp_str_.contains(&quot;\\S&quot;)) &amp;&amp;
</a><a href="#h42-2-6" id="h42-2-6" class="i">+          text.contains(&quot;\v&quot;)) {
</a><a href="#h42-2-7" id="h42-2-7" class="i">+        result-&gt;skipped = true;
</a><a href="#h42-2-8" id="h42-2-8" class="i">+        break;
</a><a href="#h42-2-9" id="h42-2-9" class="i">+      }
</a><a href="#h42-2-10" id="h42-2-10" class="i">+
</a>       const PCRE::Arg **argptr = new const PCRE::Arg*[nsubmatch];
       PCRE::Arg *a = new PCRE::Arg[nsubmatch];
       for (int i = 0; i &lt; nsubmatch; i++) {
<a href="#h42-3" id="h42-3" class="h">@@ -592,14 +602,14 @@ Tester::Tester(const StringPiece&amp; regexp) {
</a> }
 
 Tester::~Tester() {
<a href="#h42-3-3" id="h42-3-3" class="d">-  for (int i = 0; i &lt; v_.size(); i++)
</a><a href="#h42-3-4" id="h42-3-4" class="i">+  for (size_t i = 0; i &lt; v_.size(); i++)
</a>     delete v_[i];
 }
 
 bool Tester::TestCase(const StringPiece&amp; text, const StringPiece&amp; context,
                          Prog::Anchor anchor) {
   bool okay = true;
<a href="#h42-3-11" id="h42-3-11" class="d">-  for (int i = 0; i &lt; v_.size(); i++)
</a><a href="#h42-3-12" id="h42-3-12" class="i">+  for (size_t i = 0; i &lt; v_.size(); i++)
</a>     okay &amp;= (!v_[i]-&gt;error() &amp;&amp; v_[i]-&gt;RunCase(text, context, anchor));
   return okay;
 }
<b>diff --git a/<a id="h43" href="../file/src/vendor/re2/re2/testing/tester.h">src/vendor/re2/re2/testing/tester.h</a> b/<a href="../file/src/vendor/re2/re2/testing/tester.h">src/vendor/re2/re2/testing/tester.h</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -84,7 +84,7 @@ class TestInstance {
</a>   PCRE* re_;                        // PCRE implementation
   RE2* re2_;                        // RE2 implementation
 
<a href="#h43-0-3" id="h43-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(TestInstance);
</a><a href="#h43-0-4" id="h43-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(TestInstance);
</a> };
 
 // A group of TestInstances for all possible configurations.
<a href="#h43-1" id="h43-1" class="h">@@ -110,7 +110,7 @@ class Tester {
</a>   bool error_;
   vector&lt;TestInstance*&gt; v_;
 
<a href="#h43-1-3" id="h43-1-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(Tester);
</a><a href="#h43-1-4" id="h43-1-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(Tester);
</a> };
 
 // Run all possible tests using regexp and text.
<b>diff --git a/<a id="h44" href="../file/src/vendor/re2/re2/tostring.cc">src/vendor/re2/re2/tostring.cc</a> b/<a href="../file/src/vendor/re2/re2/tostring.cc">src/vendor/re2/re2/tostring.cc</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -42,7 +42,7 @@ class ToStringWalker : public Regexp::Walker&lt;int&gt; {
</a>  private:
   string* t_;  // The string the walker appends to.
 
<a href="#h44-0-3" id="h44-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(ToStringWalker);
</a><a href="#h44-0-4" id="h44-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(ToStringWalker);
</a> };
 
 string Regexp::ToString() {
<b>diff --git a/<a id="h45" href="../file/src/vendor/re2/re2/unicode_casefold.h">src/vendor/re2/re2/unicode_casefold.h</a> b/<a href="../file/src/vendor/re2/re2/unicode_casefold.h">src/vendor/re2/re2/unicode_casefold.h</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -51,8 +51,8 @@ enum {
</a> };
 
 struct CaseFold {
<a href="#h45-0-3" id="h45-0-3" class="d">-  uint32 lo;
</a><a href="#h45-0-4" id="h45-0-4" class="d">-  uint32 hi;
</a><a href="#h45-0-5" id="h45-0-5" class="i">+  Rune lo;
</a><a href="#h45-0-6" id="h45-0-6" class="i">+  Rune hi;
</a>   int32 delta;
 };
 
<b>diff --git a/<a id="h46" href="../file/src/vendor/re2/re2/unicode_groups.h">src/vendor/re2/re2/unicode_groups.h</a> b/<a href="../file/src/vendor/re2/re2/unicode_groups.h">src/vendor/re2/re2/unicode_groups.h</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -30,8 +30,8 @@ struct URange16
</a> 
 struct URange32
 {
<a href="#h46-0-3" id="h46-0-3" class="d">-  uint32 lo;
</a><a href="#h46-0-4" id="h46-0-4" class="d">-  uint32 hi;
</a><a href="#h46-0-5" id="h46-0-5" class="i">+  Rune lo;
</a><a href="#h46-0-6" id="h46-0-6" class="i">+  Rune hi;
</a> };
 
 struct UGroup
<b>diff --git a/<a id="h47" href="../file/src/vendor/re2/re2/walker-inl.h">src/vendor/re2/re2/walker-inl.h</a> b/<a href="../file/src/vendor/re2/re2/walker-inl.h">src/vendor/re2/re2/walker-inl.h</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -92,7 +92,7 @@ template&lt;typename T&gt; class Regexp::Walker {
</a> 
   T WalkInternal(Regexp* re, T top_arg, bool use_copy);
 
<a href="#h47-0-3" id="h47-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(Walker);
</a><a href="#h47-0-4" id="h47-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(Walker);
</a> };
 
 template&lt;typename T&gt; T Regexp::Walker&lt;T&gt;::PreVisit(Regexp* re,
<b>diff --git a/<a id="h48" href="../file/src/vendor/re2/util/arena.cc">src/vendor/re2/util/arena.cc</a> b/<a href="../file/src/vendor/re2/util/arena.cc">src/vendor/re2/util/arena.cc</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -114,10 +114,10 @@ void* UnsafeArena::GetMemoryFallback(const size_t size, const int align) {
</a>     return AllocNewBlock(size)-&gt;mem;
   }
 
<a href="#h48-0-3" id="h48-0-3" class="d">-  const int overage =
</a><a href="#h48-0-4" id="h48-0-4" class="i">+  const size_t overage =
</a>     (reinterpret_cast&lt;uintptr_t&gt;(freestart_) &amp; (align-1));
   if (overage) {
<a href="#h48-0-7" id="h48-0-7" class="d">-    const int waste = align - overage;
</a><a href="#h48-0-8" id="h48-0-8" class="i">+    const size_t waste = align - overage;
</a>     freestart_ += waste;
     if (waste &lt; remaining_) {
       remaining_ -= waste;
<b>diff --git a/<a id="h49" href="../file/src/vendor/re2/util/arena.h">src/vendor/re2/util/arena.h</a> b/<a href="../file/src/vendor/re2/util/arena.h">src/vendor/re2/util/arena.h</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -83,7 +83,7 @@ class UnsafeArena {
</a> 
   void FreeBlocks();         // Frees all except first block
 
<a href="#h49-0-3" id="h49-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(UnsafeArena);
</a><a href="#h49-0-4" id="h49-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(UnsafeArena);
</a> };
 
 // Operators for allocation on the arena
<b>diff --git a/<a id="h50" href="../file/src/vendor/re2/util/atomicops.h">src/vendor/re2/util/atomicops.h</a> b/<a href="../file/src/vendor/re2/util/atomicops.h">src/vendor/re2/util/atomicops.h</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -11,8 +11,11 @@
</a> // ACQUIRE - prevents memory accesses from hoisting above the operation.
 // RELEASE - prevents memory accesses from sinking below the operation.
 
<a href="#h50-0-3" id="h50-0-3" class="d">-#if (__clang_major__ * 100 + __clang_minor__ &gt;= 303) || \
</a><a href="#h50-0-4" id="h50-0-4" class="d">-	(__GNUC__ * 1000 + __GNUC_MINOR__ * 100 + __GNUC_PATCHLEVEL__ &gt;= 40801)
</a><a href="#h50-0-5" id="h50-0-5" class="i">+#ifndef __has_builtin
</a><a href="#h50-0-6" id="h50-0-6" class="i">+#define __has_builtin(x) 0
</a><a href="#h50-0-7" id="h50-0-7" class="i">+#endif
</a><a href="#h50-0-8" id="h50-0-8" class="i">+
</a><a href="#h50-0-9" id="h50-0-9" class="i">+#if !defined(OS_NACL) &amp;&amp; (__has_builtin(__atomic_load_n) || (__GNUC__*10000 + __GNUC_MINOR__*100 + __GNUC_PATCHLEVEL__ &gt;= 40801))
</a> 
 #define ATOMIC_LOAD_RELAXED(x, p) do { (x) = __atomic_load_n((p), __ATOMIC_RELAXED); } while (0)
 #define ATOMIC_LOAD_CONSUME(x, p) do { (x) = __atomic_load_n((p), __ATOMIC_CONSUME); } while (0)
<a href="#h50-1" id="h50-1" class="h">@@ -47,7 +50,7 @@ static inline void WriteMemoryBarrier() {
</a>   __asm__ __volatile__(&quot;sfence&quot; : : : &quot;memory&quot;);
 }
 
<a href="#h50-1-3" id="h50-1-3" class="d">-#elif defined(__ppc__)
</a><a href="#h50-1-4" id="h50-1-4" class="i">+#elif defined(__ppc__) || defined(__powerpc64__)
</a> 
 static inline void WriteMemoryBarrier() {
   __asm__ __volatile__(&quot;eieio&quot; : : : &quot;memory&quot;);
<a href="#h50-2" id="h50-2" class="h">@@ -65,6 +68,34 @@ static inline void WriteMemoryBarrier() {
</a>   __asm__ __volatile__(&quot;dmb st&quot; : : : &quot;memory&quot;);
 }
 
<a href="#h50-2-3" id="h50-2-3" class="i">+#elif defined(__arm__) &amp;&amp; defined(__linux__)
</a><a href="#h50-2-4" id="h50-2-4" class="i">+
</a><a href="#h50-2-5" id="h50-2-5" class="i">+// Linux on ARM puts a suitable memory barrier at a magic address for us to call.
</a><a href="#h50-2-6" id="h50-2-6" class="i">+static inline void WriteMemoryBarrier() {
</a><a href="#h50-2-7" id="h50-2-7" class="i">+  ((void(*)(void))0xffff0fa0)();
</a><a href="#h50-2-8" id="h50-2-8" class="i">+}
</a><a href="#h50-2-9" id="h50-2-9" class="i">+
</a><a href="#h50-2-10" id="h50-2-10" class="i">+#elif defined(__windows__)
</a><a href="#h50-2-11" id="h50-2-11" class="i">+
</a><a href="#h50-2-12" id="h50-2-12" class="i">+// Windows
</a><a href="#h50-2-13" id="h50-2-13" class="i">+inline void WriteMemoryBarrier() {
</a><a href="#h50-2-14" id="h50-2-14" class="i">+  LONG x;
</a><a href="#h50-2-15" id="h50-2-15" class="i">+  ::InterlockedExchange(&amp;x, 0);
</a><a href="#h50-2-16" id="h50-2-16" class="i">+}
</a><a href="#h50-2-17" id="h50-2-17" class="i">+
</a><a href="#h50-2-18" id="h50-2-18" class="i">+#elif defined(OS_NACL)
</a><a href="#h50-2-19" id="h50-2-19" class="i">+
</a><a href="#h50-2-20" id="h50-2-20" class="i">+// Native Client
</a><a href="#h50-2-21" id="h50-2-21" class="i">+inline void WriteMemoryBarrier() {
</a><a href="#h50-2-22" id="h50-2-22" class="i">+  __sync_synchronize();
</a><a href="#h50-2-23" id="h50-2-23" class="i">+}
</a><a href="#h50-2-24" id="h50-2-24" class="i">+
</a><a href="#h50-2-25" id="h50-2-25" class="i">+#elif defined(__mips__)
</a><a href="#h50-2-26" id="h50-2-26" class="i">+
</a><a href="#h50-2-27" id="h50-2-27" class="i">+inline void WriteMemoryBarrier() {
</a><a href="#h50-2-28" id="h50-2-28" class="i">+  __asm__ __volatile__(&quot;sync&quot; : : : &quot;memory&quot;);
</a><a href="#h50-2-29" id="h50-2-29" class="i">+}
</a><a href="#h50-2-30" id="h50-2-30" class="i">+
</a> #else
 
 #include &quot;util/mutex.h&quot;
<a href="#h50-3" id="h50-3" class="h">@@ -122,6 +153,12 @@ static inline void ReadMemoryBarrier() {
</a>   __asm__ __volatile__(&quot;mb&quot; : : : &quot;memory&quot;);
 }
 
<a href="#h50-3-3" id="h50-3-3" class="i">+#elif defined(__mips__)
</a><a href="#h50-3-4" id="h50-3-4" class="i">+
</a><a href="#h50-3-5" id="h50-3-5" class="i">+inline void ReadMemoryBarrier() {
</a><a href="#h50-3-6" id="h50-3-6" class="i">+  __asm__ __volatile__(&quot;sync&quot; : : : &quot;memory&quot;);
</a><a href="#h50-3-7" id="h50-3-7" class="i">+}
</a><a href="#h50-3-8" id="h50-3-8" class="i">+
</a> #else
 
 static inline void ReadMemoryBarrier() {}
<b>diff --git a/<a id="h51" href="../file/src/vendor/re2/util/logging.h">src/vendor/re2/util/logging.h</a> b/<a href="../file/src/vendor/re2/util/logging.h">src/vendor/re2/util/logging.h</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -68,7 +68,7 @@ class LogMessage {
</a>  private:
   bool flushed_;
   std::ostringstream str_;
<a href="#h51-0-3" id="h51-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(LogMessage);
</a><a href="#h51-0-4" id="h51-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(LogMessage);
</a> };
 
 class LogMessageFatal : public LogMessage {
<a href="#h51-1" id="h51-1" class="h">@@ -80,7 +80,7 @@ class LogMessageFatal : public LogMessage {
</a>     abort();
   }
  private:
<a href="#h51-1-3" id="h51-1-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(LogMessageFatal);
</a><a href="#h51-1-4" id="h51-1-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(LogMessageFatal);
</a> };
 
 #endif  // RE2_UTIL_LOGGING_H__
<b>diff --git a/<a id="h52" href="../file/src/vendor/re2/util/pcre.cc">src/vendor/re2/util/pcre.cc</a> b/<a href="../file/src/vendor/re2/util/pcre.cc">src/vendor/re2/util/pcre.cc</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -347,7 +347,7 @@ int PCRE::GlobalReplace(string *str,
</a>   int count = 0;
   int vec[kVecSize];
   string out;
<a href="#h52-0-3" id="h52-0-3" class="d">-  int start = 0;
</a><a href="#h52-0-4" id="h52-0-4" class="i">+  size_t start = 0;
</a>   bool last_match_was_empty_string = false;
 
   for (; start &lt;= str-&gt;length();) {
<a href="#h52-1" id="h52-1" class="h">@@ -377,7 +377,7 @@ int PCRE::GlobalReplace(string *str,
</a>       if (matches &lt;= 0)
         break;
     }
<a href="#h52-1-3" id="h52-1-3" class="d">-    int matchstart = vec[0], matchend = vec[1];
</a><a href="#h52-1-4" id="h52-1-4" class="i">+    size_t matchstart = vec[0], matchend = vec[1];
</a>     assert(matchstart &gt;= start);
     assert(matchend &gt;= matchstart);
 
<b>diff --git a/<a id="h53" href="../file/src/vendor/re2/util/pcre.h">src/vendor/re2/util/pcre.h</a> b/<a href="../file/src/vendor/re2/util/pcre.h">src/vendor/re2/util/pcre.h</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -510,7 +510,7 @@ class PCRE {
</a>   int               match_limit_;    // Limit on execution resources
   int               stack_limit_;    // Limit on stack resources (bytes)
   mutable int32_t  hit_limit_;  // Hit limit during execution (bool)?
<a href="#h53-0-3" id="h53-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(PCRE);
</a><a href="#h53-0-4" id="h53-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(PCRE);
</a> };
 
 // PCRE_Options allow you to set the PCRE::Options, plus any pcre
<b>diff --git a/<a id="h54" href="../file/src/vendor/re2/util/sparse_array.h">src/vendor/re2/util/sparse_array.h</a> b/<a href="../file/src/vendor/re2/util/sparse_array.h">src/vendor/re2/util/sparse_array.h</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -226,7 +226,7 @@ class SparseArray {
</a>   vector&lt;IndexValue&gt; dense_;
   bool valgrind_;
 
<a href="#h54-0-3" id="h54-0-3" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(SparseArray);
</a><a href="#h54-0-4" id="h54-0-4" class="i">+  DISALLOW_COPY_AND_ASSIGN(SparseArray);
</a> };
 
 template&lt;typename Value&gt;
<a href="#h54-1" id="h54-1" class="h">@@ -294,7 +294,7 @@ template&lt;typename Value&gt;
</a> bool SparseArray&lt;Value&gt;::has_index(int i) const {
   DCHECK_GE(i, 0);
   DCHECK_LT(i, max_size_);
<a href="#h54-1-3" id="h54-1-3" class="d">-  if (static_cast&lt;uint&gt;(i) &gt;= max_size_) {
</a><a href="#h54-1-4" id="h54-1-4" class="i">+  if (static_cast&lt;uint&gt;(i) &gt;= static_cast&lt;uint&gt;(max_size_)) {
</a>     return false;
   }
   // Unsigned comparison avoids checking sparse_to_dense_[i] &lt; 0.
<a href="#h54-2" id="h54-2" class="h">@@ -306,7 +306,7 @@ bool SparseArray&lt;Value&gt;::has_index(int i) const {
</a> template&lt;typename Value&gt;
 typename SparseArray&lt;Value&gt;::iterator SparseArray&lt;Value&gt;::set(int i, Value v) {
   DebugCheckInvariants();
<a href="#h54-2-3" id="h54-2-3" class="d">-  if (static_cast&lt;uint&gt;(i) &gt;= max_size_) {
</a><a href="#h54-2-4" id="h54-2-4" class="i">+  if (static_cast&lt;uint&gt;(i) &gt;= static_cast&lt;uint&gt;(max_size_)) {
</a>     // Semantically, end() would be better here, but we already know
     // the user did something stupid, so begin() insulates them from
     // dereferencing an invalid pointer.
<a href="#h54-3" id="h54-3" class="h">@@ -368,7 +368,7 @@ template&lt;typename Value&gt;
</a> typename SparseArray&lt;Value&gt;::iterator
 SparseArray&lt;Value&gt;::set_new(int i, Value v) {
   DebugCheckInvariants();
<a href="#h54-3-3" id="h54-3-3" class="d">-  if (static_cast&lt;uint&gt;(i) &gt;= max_size_) {
</a><a href="#h54-3-4" id="h54-3-4" class="i">+  if (static_cast&lt;uint&gt;(i) &gt;= static_cast&lt;uint&gt;(max_size_)) {
</a>     // Semantically, end() would be better here, but we already know
     // the user did something stupid, so begin() insulates them from
     // dereferencing an invalid pointer.
<b>diff --git a/<a id="h55" href="../file/src/vendor/re2/util/sparse_set.h">src/vendor/re2/util/sparse_set.h</a> b/<a href="../file/src/vendor/re2/util/sparse_set.h">src/vendor/re2/util/sparse_set.h</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -51,19 +51,28 @@
</a> 
 namespace re2 {
 
<a href="#h55-0-3" id="h55-0-3" class="i">+static bool InitMemory() {
</a><a href="#h55-0-4" id="h55-0-4" class="i">+#ifdef MEMORY_SANITIZER
</a><a href="#h55-0-5" id="h55-0-5" class="i">+  return true;
</a><a href="#h55-0-6" id="h55-0-6" class="i">+#else
</a><a href="#h55-0-7" id="h55-0-7" class="i">+  return RunningOnValgrind();
</a><a href="#h55-0-8" id="h55-0-8" class="i">+#endif
</a><a href="#h55-0-9" id="h55-0-9" class="i">+}
</a><a href="#h55-0-10" id="h55-0-10" class="i">+
</a> class SparseSet {
  public:
   SparseSet()
<a href="#h55-0-14" id="h55-0-14" class="d">-    : size_(0), max_size_(0), sparse_to_dense_(NULL), dense_(NULL), valgrind_(RunningOnValgrind()) {}
</a><a href="#h55-0-15" id="h55-0-15" class="i">+    : size_(0), max_size_(0), sparse_to_dense_(NULL), dense_(NULL),
</a><a href="#h55-0-16" id="h55-0-16" class="i">+      init_memory_(InitMemory()) {}
</a> 
   SparseSet(int max_size) {
     max_size_ = max_size;
     sparse_to_dense_ = new int[max_size];
     dense_ = new int[max_size];
<a href="#h55-0-22" id="h55-0-22" class="d">-    valgrind_ = RunningOnValgrind();
</a><a href="#h55-0-23" id="h55-0-23" class="i">+    init_memory_ = InitMemory();
</a>     // Don&#39;t need to zero the memory, but do so anyway
     // to appease Valgrind.
<a href="#h55-0-26" id="h55-0-26" class="d">-    if (valgrind_) {
</a><a href="#h55-0-27" id="h55-0-27" class="i">+    if (init_memory_) {
</a>       for (int i = 0; i &lt; max_size; i++) {
         dense_[i] = 0xababababU;
         sparse_to_dense_[i] = 0xababababU;
<a href="#h55-1" id="h55-1" class="h">@@ -95,7 +104,7 @@ class SparseSet {
</a>       int* a = new int[new_max_size];
       if (sparse_to_dense_) {
         memmove(a, sparse_to_dense_, max_size_*sizeof a[0]);
<a href="#h55-1-3" id="h55-1-3" class="d">-        if (valgrind_) {
</a><a href="#h55-1-4" id="h55-1-4" class="i">+        if (init_memory_) {
</a>           for (int i = max_size_; i &lt; new_max_size; i++)
             a[i] = 0xababababU;
         }
<a href="#h55-2" id="h55-2" class="h">@@ -106,7 +115,7 @@ class SparseSet {
</a>       a = new int[new_max_size];
       if (dense_) {
         memmove(a, dense_, size_*sizeof a[0]);
<a href="#h55-2-3" id="h55-2-3" class="d">-        if (valgrind_) {
</a><a href="#h55-2-4" id="h55-2-4" class="i">+        if (init_memory_) {
</a>           for (int i = size_; i &lt; new_max_size; i++)
             a[i] = 0xababababU;
         }
<a href="#h55-3" id="h55-3" class="h">@@ -128,7 +137,7 @@ class SparseSet {
</a>   bool contains(int i) const {
     DCHECK_GE(i, 0);
     DCHECK_LT(i, max_size_);
<a href="#h55-3-3" id="h55-3-3" class="d">-    if (static_cast&lt;uint&gt;(i) &gt;= max_size_) {
</a><a href="#h55-3-4" id="h55-3-4" class="i">+    if (static_cast&lt;uint&gt;(i) &gt;= static_cast&lt;uint&gt;(max_size_)) {
</a>       return false;
     }
     // Unsigned comparison avoids checking sparse_to_dense_[i] &lt; 0.
<a href="#h55-4" id="h55-4" class="h">@@ -145,7 +154,7 @@ class SparseSet {
</a>   // Set the value at the new index i to v.
   // Fast but unsafe: only use if contains(i) is false.
   void insert_new(int i) {
<a href="#h55-4-3" id="h55-4-3" class="d">-    if (static_cast&lt;uint&gt;(i) &gt;= max_size_) {
</a><a href="#h55-4-4" id="h55-4-4" class="i">+    if (static_cast&lt;uint&gt;(i) &gt;= static_cast&lt;uint&gt;(max_size_)) {
</a>       // Semantically, end() would be better here, but we already know
       // the user did something stupid, so begin() insulates them from
       // dereferencing an invalid pointer.
<a href="#h55-5" id="h55-5" class="h">@@ -169,9 +178,9 @@ class SparseSet {
</a>   int max_size_;
   int* sparse_to_dense_;
   int* dense_;
<a href="#h55-5-3" id="h55-5-3" class="d">-  bool valgrind_;
</a><a href="#h55-5-4" id="h55-5-4" class="i">+  bool init_memory_;
</a> 
<a href="#h55-5-6" id="h55-5-6" class="d">-  DISALLOW_EVIL_CONSTRUCTORS(SparseSet);
</a><a href="#h55-5-7" id="h55-5-7" class="i">+  DISALLOW_COPY_AND_ASSIGN(SparseSet);
</a> };
 
 }  // namespace re2
<b>diff --git a/<a id="h56" href="../file/src/vendor/re2/util/stringpiece.cc">src/vendor/re2/util/stringpiece.cc</a> b/<a href="../file/src/vendor/re2/util/stringpiece.cc">src/vendor/re2/util/stringpiece.cc</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -39,6 +39,10 @@ int StringPiece::copy(char* buf, size_type n, size_type pos) const {
</a>   return ret;
 }
 
<a href="#h56-0-3" id="h56-0-3" class="i">+bool StringPiece::contains(StringPiece s) const {
</a><a href="#h56-0-4" id="h56-0-4" class="i">+  return (size_t)find(s, 0) != npos;
</a><a href="#h56-0-5" id="h56-0-5" class="i">+}
</a><a href="#h56-0-6" id="h56-0-6" class="i">+
</a> int StringPiece::find(const StringPiece&amp; s, size_type pos) const {
   if (length_ &lt; 0 || pos &gt; static_cast&lt;size_type&gt;(length_))
     return npos;
<a href="#h56-1" id="h56-1" class="h">@@ -46,7 +50,7 @@ int StringPiece::find(const StringPiece&amp; s, size_type pos) const {
</a>   const char* result = std::search(ptr_ + pos, ptr_ + length_,
                                    s.ptr_, s.ptr_ + s.length_);
   const size_type xpos = result - ptr_;
<a href="#h56-1-3" id="h56-1-3" class="d">-  return xpos + s.length_ &lt;= length_ ? xpos : npos;
</a><a href="#h56-1-4" id="h56-1-4" class="i">+  return xpos + s.length_ &lt;= static_cast&lt;size_type&gt;(length_) ? xpos : npos;
</a> }
 
 int StringPiece::find(char c, size_type pos) const {
<a href="#h56-2" id="h56-2" class="h">@@ -79,7 +83,7 @@ int StringPiece::rfind(char c, size_type pos) const {
</a> }
 
 StringPiece StringPiece::substr(size_type pos, size_type n) const {
<a href="#h56-2-3" id="h56-2-3" class="d">-  if (pos &gt; length_) pos = length_;
</a><a href="#h56-2-4" id="h56-2-4" class="i">+  if (pos &gt; static_cast&lt;size_type&gt;(length_)) pos = static_cast&lt;size_type&gt;(length_);
</a>   if (n &gt; length_ - pos) n = length_ - pos;
   return StringPiece(ptr_ + pos, n);
 }
<b>diff --git a/<a id="h57" href="../file/src/vendor/re2/util/stringprintf.cc">src/vendor/re2/util/stringprintf.cc</a> b/<a href="../file/src/vendor/re2/util/stringprintf.cc">src/vendor/re2/util/stringprintf.cc</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -18,7 +18,7 @@ static void StringAppendV(string* dst, const char* format, va_list ap) {
</a>   int result = vsnprintf(space, sizeof(space), format, backup_ap);
   va_end(backup_ap);
 
<a href="#h57-0-3" id="h57-0-3" class="d">-  if ((result &gt;= 0) &amp;&amp; (result &lt; sizeof(space))) {
</a><a href="#h57-0-4" id="h57-0-4" class="i">+  if ((result &gt;= 0) &amp;&amp; (static_cast&lt;unsigned long&gt;(result) &lt; sizeof(space))) {
</a>     // It fit
     dst-&gt;append(space, result);
     return;
<b>diff --git a/<a id="h58" href="../file/src/vendor/re2/util/test.cc">src/vendor/re2/util/test.cc</a> b/<a href="../file/src/vendor/re2/util/test.cc">src/vendor/re2/util/test.cc</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -3,7 +3,9 @@
</a> // license that can be found in the LICENSE file.
 
 #include &lt;stdio.h&gt;
<a href="#h58-0-3" id="h58-0-3" class="i">+#ifndef WIN32
</a> #include &lt;sys/resource.h&gt;
<a href="#h58-0-5" id="h58-0-5" class="i">+#endif
</a> #include &quot;util/test.h&quot;
 
 DEFINE_string(test_tmpdir, &quot;/var/tmp&quot;, &quot;temp directory&quot;);
<a href="#h58-1" id="h58-1" class="h">@@ -23,9 +25,13 @@ void RegisterTest(void (*fn)(void), const char *name) {
</a> 
 namespace re2 {
 int64 VirtualProcessSize() {
<a href="#h58-1-3" id="h58-1-3" class="i">+#ifdef WIN32
</a><a href="#h58-1-4" id="h58-1-4" class="i">+  return 0;
</a><a href="#h58-1-5" id="h58-1-5" class="i">+#else
</a>   struct rusage ru;
   getrusage(RUSAGE_SELF, &amp;ru);
   return (int64)ru.ru_maxrss*1024;
<a href="#h58-1-9" id="h58-1-9" class="i">+#endif
</a> }
 }  // namespace re2
 
<b>diff --git a/<a id="h59" href="../file/src/vendor/re2/util/test.h">src/vendor/re2/util/test.h</a> b/<a href="../file/src/vendor/re2/util/test.h">src/vendor/re2/util/test.h</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -31,8 +31,6 @@ class TestRegisterer {
</a> #define EXPECT_GE CHECK_GE
 #define EXPECT_FALSE(x) CHECK(!(x))
 
<a href="#h59-0-3" id="h59-0-3" class="d">-#define ARRAYSIZE arraysize
</a><a href="#h59-0-4" id="h59-0-4" class="d">-
</a> #define EXPECT_TRUE_M(x, y) CHECK(x) &lt;&lt; (y)
 #define EXPECT_FALSE_M(x, y) CHECK(!(x)) &lt;&lt; (y)
 #define ASSERT_TRUE_M(x, y) CHECK(x) &lt;&lt; (y)
<b>diff --git a/<a id="h60" href="../file/src/vendor/re2/util/threadwin.cc">src/vendor/re2/util/threadwin.cc</a> b/<a href="../file/src/vendor/re2/util/threadwin.cc">src/vendor/re2/util/threadwin.cc</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -0,0 +1,49 @@
</a><a href="#h60-0-0" id="h60-0-0" class="i">+// Copyright 2009 The RE2 Authors.  All Rights Reserved.
</a><a href="#h60-0-1" id="h60-0-1" class="i">+// Use of this source code is governed by a BSD-style
</a><a href="#h60-0-2" id="h60-0-2" class="i">+// license that can be found in the LICENSE file.
</a><a href="#h60-0-3" id="h60-0-3" class="i">+
</a><a href="#h60-0-4" id="h60-0-4" class="i">+#include &lt;windows.h&gt;
</a><a href="#h60-0-5" id="h60-0-5" class="i">+
</a><a href="#h60-0-6" id="h60-0-6" class="i">+#include &quot;util/util.h&quot;
</a><a href="#h60-0-7" id="h60-0-7" class="i">+#include &quot;util/thread.h&quot;
</a><a href="#h60-0-8" id="h60-0-8" class="i">+
</a><a href="#h60-0-9" id="h60-0-9" class="i">+Thread::Thread() {
</a><a href="#h60-0-10" id="h60-0-10" class="i">+  pid_ = 0;
</a><a href="#h60-0-11" id="h60-0-11" class="i">+  running_ = 0;
</a><a href="#h60-0-12" id="h60-0-12" class="i">+  joinable_ = 0;
</a><a href="#h60-0-13" id="h60-0-13" class="i">+}
</a><a href="#h60-0-14" id="h60-0-14" class="i">+
</a><a href="#h60-0-15" id="h60-0-15" class="i">+Thread::~Thread() {
</a><a href="#h60-0-16" id="h60-0-16" class="i">+}
</a><a href="#h60-0-17" id="h60-0-17" class="i">+
</a><a href="#h60-0-18" id="h60-0-18" class="i">+DWORD WINAPI startThread(void *v) {
</a><a href="#h60-0-19" id="h60-0-19" class="i">+  Thread* t = (Thread*)v;
</a><a href="#h60-0-20" id="h60-0-20" class="i">+  t-&gt;Run();
</a><a href="#h60-0-21" id="h60-0-21" class="i">+  return 0;
</a><a href="#h60-0-22" id="h60-0-22" class="i">+}
</a><a href="#h60-0-23" id="h60-0-23" class="i">+
</a><a href="#h60-0-24" id="h60-0-24" class="i">+void Thread::Start() {
</a><a href="#h60-0-25" id="h60-0-25" class="i">+  CHECK(!running_);
</a><a href="#h60-0-26" id="h60-0-26" class="i">+  pid_ = CreateThread(NULL, 0, startThread, this, 0, NULL);
</a><a href="#h60-0-27" id="h60-0-27" class="i">+  running_ = true;
</a><a href="#h60-0-28" id="h60-0-28" class="i">+  if (!joinable_)
</a><a href="#h60-0-29" id="h60-0-29" class="i">+  {
</a><a href="#h60-0-30" id="h60-0-30" class="i">+    CloseHandle(pid_);
</a><a href="#h60-0-31" id="h60-0-31" class="i">+    pid_ = 0;
</a><a href="#h60-0-32" id="h60-0-32" class="i">+  }
</a><a href="#h60-0-33" id="h60-0-33" class="i">+}
</a><a href="#h60-0-34" id="h60-0-34" class="i">+
</a><a href="#h60-0-35" id="h60-0-35" class="i">+void Thread::Join() {
</a><a href="#h60-0-36" id="h60-0-36" class="i">+  CHECK(running_);
</a><a href="#h60-0-37" id="h60-0-37" class="i">+  CHECK(joinable_);
</a><a href="#h60-0-38" id="h60-0-38" class="i">+  if (0 != pid_)
</a><a href="#h60-0-39" id="h60-0-39" class="i">+  {
</a><a href="#h60-0-40" id="h60-0-40" class="i">+      WaitForSingleObject(pid_, INFINITE);
</a><a href="#h60-0-41" id="h60-0-41" class="i">+  }
</a><a href="#h60-0-42" id="h60-0-42" class="i">+  running_ = 0;
</a><a href="#h60-0-43" id="h60-0-43" class="i">+}
</a><a href="#h60-0-44" id="h60-0-44" class="i">+
</a><a href="#h60-0-45" id="h60-0-45" class="i">+void Thread::SetJoinable(bool j) {
</a><a href="#h60-0-46" id="h60-0-46" class="i">+  CHECK(!running_);
</a><a href="#h60-0-47" id="h60-0-47" class="i">+  joinable_ = j;
</a><a href="#h60-0-48" id="h60-0-48" class="i">+}
</a><b>diff --git a/<a id="h61" href="../file/src/vendor/re2/util/util.h">src/vendor/re2/util/util.h</a> b/<a href="../file/src/vendor/re2/util/util.h">src/vendor/re2/util/util.h</a></b>
<a href="#h61-0" id="h61-0" class="h">@@ -12,11 +12,11 @@
</a> #include &lt;stddef.h&gt;         // For size_t
 #include &lt;assert.h&gt;
 #include &lt;stdarg.h&gt;
<a href="#h61-0-3" id="h61-0-3" class="d">-#include &lt;sys/time.h&gt;
</a> #include &lt;time.h&gt;
 #include &lt;ctype.h&gt;	// For isdigit, isalpha.
 
 // C++
<a href="#h61-0-8" id="h61-0-8" class="i">+#include &lt;ctime&gt;
</a> #include &lt;vector&gt;
 #include &lt;string&gt;
 #include &lt;algorithm&gt;
<a href="#h61-1" id="h61-1" class="h">@@ -57,6 +57,22 @@ using std::unordered_set;
</a> 
 #endif
 
<a href="#h61-1-3" id="h61-1-3" class="i">+#ifdef WIN32
</a><a href="#h61-1-4" id="h61-1-4" class="i">+
</a><a href="#h61-1-5" id="h61-1-5" class="i">+#define snprintf _snprintf_s
</a><a href="#h61-1-6" id="h61-1-6" class="i">+#define sprintf sprintf_s
</a><a href="#h61-1-7" id="h61-1-7" class="i">+#define stricmp _stricmp
</a><a href="#h61-1-8" id="h61-1-8" class="i">+#define strtof strtod /* not really correct but best we can do */
</a><a href="#h61-1-9" id="h61-1-9" class="i">+#define strtoll _strtoi64
</a><a href="#h61-1-10" id="h61-1-10" class="i">+#define strtoull _strtoui64
</a><a href="#h61-1-11" id="h61-1-11" class="i">+#define vsnprintf vsnprintf_s
</a><a href="#h61-1-12" id="h61-1-12" class="i">+
</a><a href="#h61-1-13" id="h61-1-13" class="i">+#pragma warning(disable: 4018) // signed/unsigned mismatch
</a><a href="#h61-1-14" id="h61-1-14" class="i">+#pragma warning(disable: 4244) // possible data loss in int conversion
</a><a href="#h61-1-15" id="h61-1-15" class="i">+#pragma warning(disable: 4800) // conversion from int to bool
</a><a href="#h61-1-16" id="h61-1-16" class="i">+
</a><a href="#h61-1-17" id="h61-1-17" class="i">+#endif
</a><a href="#h61-1-18" id="h61-1-18" class="i">+
</a> namespace re2 {
 
 typedef int8_t int8;
<a href="#h61-2" id="h61-2" class="h">@@ -81,13 +97,13 @@ template&lt;bool&gt; struct CompileAssert {};
</a>   typedef CompileAssert&lt;(bool(expr))&gt; msg[bool(expr) ? 1 : -1]
 #endif
 
<a href="#h61-2-3" id="h61-2-3" class="d">-// DISALLOW_EVIL_CONSTRUCTORS disallows the copy and operator= functions.
</a><a href="#h61-2-4" id="h61-2-4" class="i">+// DISALLOW_COPY_AND_ASSIGN disallows the copy and operator= functions.
</a> // It goes in the private: declarations in a class.
<a href="#h61-2-6" id="h61-2-6" class="d">-#define DISALLOW_EVIL_CONSTRUCTORS(TypeName) \
</a><a href="#h61-2-7" id="h61-2-7" class="i">+#define DISALLOW_COPY_AND_ASSIGN(TypeName) \
</a>   TypeName(const TypeName&amp;);                 \
   void operator=(const TypeName&amp;)
 
<a href="#h61-2-11" id="h61-2-11" class="d">-#define arraysize(array) (sizeof(array)/sizeof((array)[0]))
</a><a href="#h61-2-12" id="h61-2-12" class="i">+#define arraysize(array) (int)(sizeof(array)/sizeof((array)[0]))
</a> 
 class StringPiece;
 
<b>diff --git a/<a id="h62" href="../file/src/vendor/re2/util/valgrind.cc">src/vendor/re2/util/valgrind.cc</a> b/<a href="../file/src/vendor/re2/util/valgrind.cc">src/vendor/re2/util/valgrind.cc</a></b>
<a href="#h62-0" id="h62-0" class="h">@@ -3,7 +3,9 @@
</a> // license that can be found in the LICENSE file.
 
 #include &quot;util/util.h&quot;
<a href="#h62-0-3" id="h62-0-3" class="i">+#ifndef WIN32
</a> #include &quot;util/valgrind.h&quot;
<a href="#h62-0-5" id="h62-0-5" class="i">+#endif
</a> 
 namespace re2 {
 
<b>diff --git a/<a id="h63" href="../file/src/vendor/update.sh">src/vendor/update.sh</a> b/<a href="../file/src/vendor/update.sh">src/vendor/update.sh</a></b>
<a href="#h63-0" id="h63-0" class="h">@@ -5,7 +5,6 @@ set -eux
</a> here=&quot;$(dirname &quot;$0&quot;)&quot;
 cd &quot;$here&quot;
 
<a href="#h63-0-3" id="h63-0-3" class="d">-
</a> rm -rf re2
<a href="#h63-0-5" id="h63-0-5" class="d">-hg -R &quot;$HOME/code/re2&quot; archive -t tar -r tip - | tar x
</a><a href="#h63-0-6" id="h63-0-6" class="d">-mv re2-* re2
</a><a href="#h63-0-7" id="h63-0-7" class="i">+curl -L https://github.com/google/re2/archive/master.tar.gz | tar xzv
</a><a href="#h63-0-8" id="h63-0-8" class="i">+mv re2-master re2
</a></pre>
</div>
</body>
</html>
